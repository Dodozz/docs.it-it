---
title: Accodamento in WCF
ms.date: 03/30/2017
ms.assetid: e98d76ba-1acf-42cd-b137-0f8214661112
ms.openlocfilehash: 502f1ad74cd4bd6294db11a3e48f4c41068704ae
ms.sourcegitcommit: 5b6d778ebb269ee6684fb57ad69a8c28b06235b9
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/08/2019
ms.locfileid: "59128765"
---
# <a name="queuing-in-wcf"></a><span data-ttu-id="c5363-102">Accodamento in WCF</span><span class="sxs-lookup"><span data-stu-id="c5363-102">Queuing in WCF</span></span>
<span data-ttu-id="c5363-103">In questa sezione descrive come usare la comunicazione in coda in Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="c5363-103">This section describes how to use queued communication in Windows Communication Foundation (WCF).</span></span>  
  
## <a name="queues-as-a-wcf-transport-binding"></a><span data-ttu-id="c5363-104">Accodamento come associazione di trasporto WCF</span><span class="sxs-lookup"><span data-stu-id="c5363-104">Queues as a WCF transport binding</span></span>  
 <span data-ttu-id="c5363-105">In WCF, i contratti specificano ciò che viene scambiato.</span><span class="sxs-lookup"><span data-stu-id="c5363-105">In WCF, the contracts specify what is being exchanged.</span></span> <span data-ttu-id="c5363-106">I contratti sono scambi di messaggi dipendenti dall'azienda o specifici dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c5363-106">Contracts are business-dependent or application-specific message exchanges.</span></span> <span data-ttu-id="c5363-107">Il meccanismo (o la modalità) usato per scambiare messaggi viene specificato nelle associazioni.</span><span class="sxs-lookup"><span data-stu-id="c5363-107">The mechanism used to exchange messages (or the "how") is specified in the bindings.</span></span> <span data-ttu-id="c5363-108">Le associazioni in WCF incapsulano dettagli dello scambio di messaggi.</span><span class="sxs-lookup"><span data-stu-id="c5363-108">Bindings in WCF encapsulate details of the message exchange.</span></span> <span data-ttu-id="c5363-109">Espongono funzionalità di configurazione che consentono all'utente di controllare vari aspetti del trasporto o del protocollo rappresentato dall'associazione.</span><span class="sxs-lookup"><span data-stu-id="c5363-109">They expose configuration knobs for the user to control various aspects of the transport or the protocol that the bindings represent.</span></span> <span data-ttu-id="c5363-110">Accodamento in WCF viene trattato come qualsiasi altro binding di trasporto, ovvero un grande vantaggio per molte applicazioni di Accodamento.</span><span class="sxs-lookup"><span data-stu-id="c5363-110">Queuing in WCF is treated like any other transport binding, which is a big advantage for many queuing applications.</span></span> <span data-ttu-id="c5363-111">Oggi, molte applicazioni di accodamento vengono scritte in modo diverso dalle applicazioni distribuite in stile chiamata di procedura remota (RPC), rendendone più difficile la gestione.</span><span class="sxs-lookup"><span data-stu-id="c5363-111">Today, many queuing applications are written differently from other remote procedure call (RPC)-style distributed applications, making it harder to follow and maintain.</span></span> <span data-ttu-id="c5363-112">Con WCF, lo stile di scrittura di un'applicazione distribuita è molto simile, rendendo più semplice da seguire e gestire.</span><span class="sxs-lookup"><span data-stu-id="c5363-112">With WCF, the style of writing a distributed application is much the same, making it easier to follow and maintain.</span></span> <span data-ttu-id="c5363-113">Inoltre, eseguendo il factoring del meccanismo di scambio separatamente dalla regola business, è più semplice configurare il trasporto o apportarvi modifiche senza incidere sul codice specifico dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c5363-113">Moreover, by factoring out the mechanism of exchange separately from the business logic, it is easier to configure the transport or make changes to it without affecting application specific code.</span></span> <span data-ttu-id="c5363-114">Nella figura seguente viene illustrata la struttura di un servizio e un client WCF usando MSMQ come trasporto.</span><span class="sxs-lookup"><span data-stu-id="c5363-114">The following figure illustrates the structure of a WCF service and client using MSMQ as a transport.</span></span>  
  
 <span data-ttu-id="c5363-115">![Diagramma applicazioni accodate](../../../../docs/framework/wcf/feature-details/media/distributed-queue-figure.jpg "Distributed-coda-figura")</span><span class="sxs-lookup"><span data-stu-id="c5363-115">![Queued Application Diagram](../../../../docs/framework/wcf/feature-details/media/distributed-queue-figure.jpg "Distributed-Queue-Figure")</span></span>  
  
 <span data-ttu-id="c5363-116">Come risulta evidente dalla figura precedente, il client e il servizio devono definire solo la semantica dell'applicazione, ovvero, il contratto e l'implementazione.</span><span class="sxs-lookup"><span data-stu-id="c5363-116">As you can see from the preceding figure, the client and service must define only the application semantics, that is, the contract and implementation.</span></span> <span data-ttu-id="c5363-117">Il servizio configura un'associazione in coda con le impostazioni preferite.</span><span class="sxs-lookup"><span data-stu-id="c5363-117">The service configures a queued binding with preferred settings.</span></span> <span data-ttu-id="c5363-118">Il client usa la [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) per generare un client WCF per il servizio e generare un file di configurazione che descriva le associazioni da usare per inviare messaggi al servizio.</span><span class="sxs-lookup"><span data-stu-id="c5363-118">The client uses the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) to generate a WCF client to the service and to generate a configuration file that describes the bindings to use to send messages to the service.</span></span> <span data-ttu-id="c5363-119">Di conseguenza, per inviare un messaggio in coda, il client crea un'istanza di un client WCF e richiama un'operazione su di esso.</span><span class="sxs-lookup"><span data-stu-id="c5363-119">Thus, to send a queued message, the client instantiates a WCF client and invokes an operation on it.</span></span> <span data-ttu-id="c5363-120">Questo fa sì che il messaggio venga inviato alla coda di trasmissione e trasferito alla coda di destinazione.</span><span class="sxs-lookup"><span data-stu-id="c5363-120">This causes the message to be sent to the transmission queue and transferred to the target queue.</span></span> <span data-ttu-id="c5363-121">Tutte le complessità della comunicazione in coda vengono nascoste all'applicazione che sta inviando e ricevendo messaggi.</span><span class="sxs-lookup"><span data-stu-id="c5363-121">All the complexities of queued communication are hidden from the application that is sending and receiving messages.</span></span>  
  
 <span data-ttu-id="c5363-122">Suggerimenti relativi all'associazione in coda in WCF includono:</span><span class="sxs-lookup"><span data-stu-id="c5363-122">Caveats about queued binding in WCF include:</span></span>  
  
-   <span data-ttu-id="c5363-123">Servizio tutte le operazioni devono essere unidirezionali perché il valore predefinito in coda l'associazione in WCF non supporta la comunicazione duplex tramite code.</span><span class="sxs-lookup"><span data-stu-id="c5363-123">All service operations must be one-way because the default queued binding in WCF does not support duplex communication using queues.</span></span> <span data-ttu-id="c5363-124">Un esempio di comunicazione bidirezionale ([comunicazione bidirezionale](../../../../docs/framework/wcf/samples/two-way-communication.md)) viene illustrato come usare due contratti unidirezionali per implementare la comunicazione duplex tramite code.</span><span class="sxs-lookup"><span data-stu-id="c5363-124">A two-way communication sample ([Two-Way Communication](../../../../docs/framework/wcf/samples/two-way-communication.md)) illustrates how to use two one-way contracts to implement duplex communication using queues.</span></span>  
  
-   <span data-ttu-id="c5363-125">Per generare un WCF client mediante lo scambio di metadati richiede un endpoint HTTP aggiuntivo sul servizio in modo che è possibile eseguire query direttamente per generare il client WCF e ottenere informazioni di associazione per configurare adeguatamente la comunicazione in coda.</span><span class="sxs-lookup"><span data-stu-id="c5363-125">To generate a WCF client using metadata exchange requires an additional HTTP endpoint on the service so that it can be queried directly to generate the WCF client and obtain binding information to appropriately configure queued communication.</span></span>  
  
-   <span data-ttu-id="c5363-126">A seconda dell'associazione in coda, è necessaria una configurazione aggiuntiva all'esterno di WCF.</span><span class="sxs-lookup"><span data-stu-id="c5363-126">Based on the queued binding, extra configuration outside of WCF is required.</span></span> <span data-ttu-id="c5363-127">Ad esempio, il <xref:System.ServiceModel.NetMsmqBinding> classe che viene fornito con WCF è necessario configurare i binding, nonché configurazione minima Message Queuing (MSMQ).</span><span class="sxs-lookup"><span data-stu-id="c5363-127">For example, the <xref:System.ServiceModel.NetMsmqBinding> class that is shipped with WCF requires you to configure the bindings as well as minimally configure Message Queuing (MSMQ).</span></span>  
  
 <span data-ttu-id="c5363-128">Le sezioni seguenti descrivono le associazioni di in coda specifiche fornite con WCF, che sono basate su MSMQ.</span><span class="sxs-lookup"><span data-stu-id="c5363-128">The following sections describe the specific queued bindings shipped with WCF, which are based on MSMQ.</span></span>  
  
### <a name="msmq"></a><span data-ttu-id="c5363-129">MSMQ</span><span class="sxs-lookup"><span data-stu-id="c5363-129">MSMQ</span></span>  
 <span data-ttu-id="c5363-130">Il trasporto in coda in WCF Usa MSMQ per la comunicazione in coda.</span><span class="sxs-lookup"><span data-stu-id="c5363-130">The queued transport in WCF uses MSMQ for its queued communication.</span></span>  
  
 <span data-ttu-id="c5363-131">MSMQ viene fornito con Windows come componente facoltativo e viene eseguito come servizio NT.</span><span class="sxs-lookup"><span data-stu-id="c5363-131">MSMQ ships as an optional component with Windows and runs as an NT service.</span></span> <span data-ttu-id="c5363-132">Acquisisce i messaggi per la trasmissione in una coda di trasmissione e per il recapito in una coda di destinazione.</span><span class="sxs-lookup"><span data-stu-id="c5363-132">It captures messages for transmission in a transmission queue and for delivery in a target queue.</span></span> <span data-ttu-id="c5363-133">I gestori code MSMQ implementano un protocollo di trasferimento messaggi affidabile, in modo che i messaggi non vengano persi durante la trasmissione.</span><span class="sxs-lookup"><span data-stu-id="c5363-133">The MSMQ queue managers implement a reliable message-transfer protocol so that messages are not lost in transmission.</span></span> <span data-ttu-id="c5363-134">Il protocollo può essere nativo o basato su SOAP, ad esempio SRMP (SOAP Reliable Message Protocol).</span><span class="sxs-lookup"><span data-stu-id="c5363-134">The protocol can be either native or SOAP-based, such as the SOAP Reliable Message Protocol (SRMP).</span></span>  
  
 <span data-ttu-id="c5363-135">In MSMQ, le code possono essere transazionali o non transazionali.</span><span class="sxs-lookup"><span data-stu-id="c5363-135">In MSMQ, queues can be transactional or non-transactional.</span></span> <span data-ttu-id="c5363-136">Una coda transazionale consente di acquisire e recapitare messaggi in una transazione, per poi archiviarli permanentemente nella coda.</span><span class="sxs-lookup"><span data-stu-id="c5363-136">A transactional queue allows messages to be captured and delivered in a transaction and then stored durably in the queue.</span></span> <span data-ttu-id="c5363-137">I messaggi inviati a una coda transazionale vengono trasferiti esattamente una volta in ordine.</span><span class="sxs-lookup"><span data-stu-id="c5363-137">Messages sent to a transactional queue are transferred exactly once in order.</span></span> <span data-ttu-id="c5363-138">È possibile usare una coda non transazionale per inviare messaggi volatili e durevoli.</span><span class="sxs-lookup"><span data-stu-id="c5363-138">You can use a non-transactional queue to send both volatile and durable messages.</span></span> <span data-ttu-id="c5363-139">Un messaggio inviato a una coda non transazionale non offre alcuna assicurazione di trasferimento affidabile e può quindi essere perso.</span><span class="sxs-lookup"><span data-stu-id="c5363-139">A message sent to a non-transactional queue does not carry any reliable transfer assurances; thus, messages can be lost.</span></span>  
  
 <span data-ttu-id="c5363-140">Le code MSMQ possono essere protette anche usando un'identità di Windows registrata con il servizio directory Active Directory.</span><span class="sxs-lookup"><span data-stu-id="c5363-140">MSMQ queues can also be secured using a Windows identity registered with the Active Directory directory service.</span></span> <span data-ttu-id="c5363-141">Quando si installa MSMQ, è possibile installare l'integrazione di Active Directory, che richiede che il computer faccia parte di una rete di dominio Windows.</span><span class="sxs-lookup"><span data-stu-id="c5363-141">When installing MSMQ, you can install Active Directory integration, which requires the computer to be part of a Windows domain network.</span></span>  
  
 <span data-ttu-id="c5363-142">Per altre informazioni su MSMQ, vedere [installazione di Accodamento messaggi (MSMQ)](../../../../docs/framework/wcf/samples/installing-message-queuing-msmq.md).</span><span class="sxs-lookup"><span data-stu-id="c5363-142">For more information about MSMQ, see [Installing Message Queuing (MSMQ)](../../../../docs/framework/wcf/samples/installing-message-queuing-msmq.md).</span></span>  
  
### <a name="netmsmqbinding"></a><span data-ttu-id="c5363-143">NetMsmqBinding</span><span class="sxs-lookup"><span data-stu-id="c5363-143">NetMsmqBinding</span></span>  
 <span data-ttu-id="c5363-144">Il [ \<netMsmqBinding >](../../../../docs/framework/configure-apps/file-schema/wcf/netmsmqbinding.md) è l'associazione in coda, WCF fornisce due endpoint WCF comunicare tramite MSMQ.</span><span class="sxs-lookup"><span data-stu-id="c5363-144">The [\<netMsmqBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/netmsmqbinding.md) is the queued binding WCF provides for two WCF endpoints to communicate using MSMQ.</span></span> <span data-ttu-id="c5363-145">L'associazione, pertanto, espone proprietà specifiche di MSMQ.</span><span class="sxs-lookup"><span data-stu-id="c5363-145">The binding, therefore, exposes properties that are specific to MSMQ.</span></span> <span data-ttu-id="c5363-146">Tuttavia, non tutte le funzionalità e le proprietà di MSMQ vengono esposte in `NetMsmqBinding`.</span><span class="sxs-lookup"><span data-stu-id="c5363-146">However, not all MSMQ features and properties are exposed in the `NetMsmqBinding`.</span></span> <span data-ttu-id="c5363-147">La classe compatta `NetMsmqBinding` è progettata con un set ottimale di funzionalità che la maggior parte dei clienti dovrebbe trovare sufficiente.</span><span class="sxs-lookup"><span data-stu-id="c5363-147">The compact `NetMsmqBinding` is designed with an optimal set of features that most customers should find sufficient.</span></span>  
  
 <span data-ttu-id="c5363-148">La classe `NetMsmqBinding` manifesta i principali concetti di accodamento descritti fino ad ora nella forma di proprietà sulle associazioni.</span><span class="sxs-lookup"><span data-stu-id="c5363-148">The `NetMsmqBinding` manifests the core queuing concepts discussed thus far in the form of properties on the bindings.</span></span> <span data-ttu-id="c5363-149">Queste proprietà, a loro volta, comunicano a MSMQ come trasferire e recapitare i messaggi.</span><span class="sxs-lookup"><span data-stu-id="c5363-149">These properties, in turn, communicate to MSMQ how to transfer and deliver the messages.</span></span> <span data-ttu-id="c5363-150">Nelle sezioni seguenti vengono descritte le categorie di proprietà.</span><span class="sxs-lookup"><span data-stu-id="c5363-150">A discussion of the property categories is in the following sections.</span></span> <span data-ttu-id="c5363-151">Per altre informazioni, vedere gli argomenti concettuali che descrivono le proprietà specifiche più completo.</span><span class="sxs-lookup"><span data-stu-id="c5363-151">For more information, see the conceptual topics that describe specific properties more completely.</span></span>  
  
#### <a name="exactlyonce-and-durable-properties"></a><span data-ttu-id="c5363-152">Proprietà ExactlyOnce e Durable</span><span class="sxs-lookup"><span data-stu-id="c5363-152">ExactlyOnce and Durable Properties</span></span>  
 <span data-ttu-id="c5363-153">Le proprietà `ExactlyOnce` e `Durable` incidono sulla modalità di trasferimento dei messaggi tra le code:</span><span class="sxs-lookup"><span data-stu-id="c5363-153">The `ExactlyOnce` and `Durable` properties affect how messages are transferred between queues:</span></span>  
  
-   `ExactlyOnce`<span data-ttu-id="c5363-154">: Se impostato su `true` (impostazione predefinita), il canale in coda assicura che il messaggio, se recapitato, non vengano duplicato.</span><span class="sxs-lookup"><span data-stu-id="c5363-154">: When set to `true` (the default), the queued channel ensures that the message, if delivered, is not duplicated.</span></span> <span data-ttu-id="c5363-155">Assicura inoltre che il messaggio non venga perso.</span><span class="sxs-lookup"><span data-stu-id="c5363-155">It also ensures that the message is not lost.</span></span> <span data-ttu-id="c5363-156">Se il messaggio non può essere recapitato o se la durata del messaggio scade prima che il messaggio possa essere recapitato, il messaggio non riuscito, insieme al motivo dell'errore di recapito, viene registrato in una coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="c5363-156">If the message cannot be delivered, or the message Time-To Live expires before the message can be delivered, the failed message along with the delivery failure reason is recorded in a dead-letter queue.</span></span> <span data-ttu-id="c5363-157">Se la proprietà è impostata su `false`, il canale in coda tenta di trasferire il messaggio.</span><span class="sxs-lookup"><span data-stu-id="c5363-157">When set to `false`, the queued channel makes an effort to transfer the message.</span></span> <span data-ttu-id="c5363-158">In questo caso, è possibile scegliere una coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="c5363-158">In this case, you can optionally choose a dead-letter queue.</span></span>  
  
-   `Durable:` <span data-ttu-id="c5363-159">Se impostato su `true` (impostazione predefinita), il canale in coda assicura che MSMQ archivi il messaggio in modo permanente sul disco.</span><span class="sxs-lookup"><span data-stu-id="c5363-159">When set to `true` (the default), the queued channel ensures that MSMQ stores the message durably on disk.</span></span> <span data-ttu-id="c5363-160">Così, se il servizio MSMQ viene interrotto e riavviato, il messaggio sul disco viene trasferito alla coda di destinazione o recapitato al servizio.</span><span class="sxs-lookup"><span data-stu-id="c5363-160">Thus, if the MSMQ service were to stop and restart, the messages on disk is transferred to the target queue or delivered to the service.</span></span> <span data-ttu-id="c5363-161">Se la proprietà è impostata su `false`, i messaggi vengono memorizzati in un archivio volatile e persi al momento dell'interruzione e del riavvio del servizio MSMQ.</span><span class="sxs-lookup"><span data-stu-id="c5363-161">When set to `false`, the messages are stored in volatile store and are lost on stopping and restarting the MSMQ service.</span></span>  
  
 <span data-ttu-id="c5363-162">Per il trasferimento affidabile `ExactlyOnce`, MSMQ richiede che la coda sia transazionale.</span><span class="sxs-lookup"><span data-stu-id="c5363-162">For `ExactlyOnce` reliable transfer, MSMQ requires the queue to be transactional.</span></span> <span data-ttu-id="c5363-163">Inoltre, MSMQ richiede una transazione da leggere da una coda transazionale.</span><span class="sxs-lookup"><span data-stu-id="c5363-163">Also, MSMQ requires a transaction to read from a transactional queue.</span></span> <span data-ttu-id="c5363-164">Se si usa `NetMsmqBinding` è quindi importante ricordare che è necessaria una transazione per inviare o ricevere messaggi quando la proprietà `ExactlyOnce` è impostata su `true`.</span><span class="sxs-lookup"><span data-stu-id="c5363-164">As such, when you use the `NetMsmqBinding`, remember that a transaction is required to send or receive messages when `ExactlyOnce` is set to `true`.</span></span> <span data-ttu-id="c5363-165">Allo stesso modo, MSMQ richiede che la coda sia non transazionale per le situazioni che necessitano del massimo sforzo, come quando `ExactlyOnce` è `false` e per la messaggistica volatile.</span><span class="sxs-lookup"><span data-stu-id="c5363-165">Similarly, MSMQ requires the queue to be non-transactional for best-effort assurances, such as when `ExactlyOnce` is `false` and for volatile messaging.</span></span> <span data-ttu-id="c5363-166">Quindi, quando si imposta `ExactlyOnce` su `false` o Durable su `false`, non è possibile inviare o ricevere messaggi usando una transazione.</span><span class="sxs-lookup"><span data-stu-id="c5363-166">Thus, when setting `ExactlyOnce` to `false` or durable to `false`, you cannot send or receive using a transaction.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c5363-167">Assicurarsi che venga creata la coda corretta (transazionale o non transazionale) in base alle impostazioni nelle associazioni.</span><span class="sxs-lookup"><span data-stu-id="c5363-167">Ensure that the correct queue (transactional or non-transactional) is created based on settings in the bindings.</span></span> <span data-ttu-id="c5363-168">Se `ExactlyOnce` è `true`, usare una coda transazionale; altrimenti, usare una coda non transazionale.</span><span class="sxs-lookup"><span data-stu-id="c5363-168">If `ExactlyOnce` is `true`, use a transactional queue; otherwise, use a non-transactional queue.</span></span>  
  
#### <a name="dead-letter-queue-properties"></a><span data-ttu-id="c5363-169">Proprietà della coda di messaggi non recapitabili</span><span class="sxs-lookup"><span data-stu-id="c5363-169">Dead-Letter Queue Properties</span></span>  
 <span data-ttu-id="c5363-170">La coda di messaggi non recapitabili viene usata per archiviare i messaggi il cui recapito ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="c5363-170">The dead-letter queue is used to store messages that fail delivery.</span></span> <span data-ttu-id="c5363-171">L'utente può scrivere una logica di compensazione che legga i messaggi dalla coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="c5363-171">The user can write compensating logic that reads messages out of the dead-letter queue.</span></span>  
  
 <span data-ttu-id="c5363-172">Molti sistemi di accodamento prevedono una coda di messaggi non recapitabili a livello di sistema.</span><span class="sxs-lookup"><span data-stu-id="c5363-172">Many queuing systems provide for a system-wide dead-letter queue.</span></span> <span data-ttu-id="c5363-173">MSMQ include una coda di messaggi non recapitabili non transazionale a livello di sistema per i messaggi il cui recapito nelle code non transazionali ha esito negativo e una coda di messaggi non recapitabili transazionale a livello di sistema per i messaggi il cui recapito nelle code transazionali ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="c5363-173">MSMQ provides a system-wide non-transactional dead-letter queue for messages that fail delivery to non-transactional queues and a system-wide transactional dead-letter queue for messages that fail delivery to transactional queues.</span></span>  
  
 <span data-ttu-id="c5363-174">Se più client che inviano messaggi a code di destinazione diverse condividono il servizio MSMQ, tutti i messaggi inviati dai client finiranno nella stessa coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="c5363-174">If multiple clients sending messages to different target queues share the MSMQ service, all messages sent by the clients go to the same dead-letter queue.</span></span> <span data-ttu-id="c5363-175">Ciò non è sempre preferibile.</span><span class="sxs-lookup"><span data-stu-id="c5363-175">This is not always preferable.</span></span> <span data-ttu-id="c5363-176">Per un migliore isolamento, WCF e MSMQ in [!INCLUDE[wv](../../../../includes/wv-md.md)] forniscono una coda dei messaggi non recapitabili personalizzata (o coda specifica dell'applicazione) che l'utente può specificare per archiviare i messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="c5363-176">For better isolation, WCF and MSMQ in [!INCLUDE[wv](../../../../includes/wv-md.md)] provide a custom dead-letter queue (or application-specific dead-letter queue) that the user can specify to store messages that fail delivery.</span></span> <span data-ttu-id="c5363-177">Pertanto, client diversi non condividono la stessa coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="c5363-177">Therefore, different clients do not share the same dead-letter queue.</span></span>  
  
 <span data-ttu-id="c5363-178">L'associazione dispone di due proprietà interessanti:</span><span class="sxs-lookup"><span data-stu-id="c5363-178">The binding has two properties of interest:</span></span>  
  
-   `DeadLetterQueue`<span data-ttu-id="c5363-179">: Questa proprietà è un'enumerazione che indica se è richiesta una coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="c5363-179">: This property is an enumeration that indicates whether a dead-letter queue is requested.</span></span> <span data-ttu-id="c5363-180">Nel caso sia necessaria, l'enumerazione contiene anche il tipo di coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="c5363-180">The enumeration also contains the kind of dead-letter queue, if one is requested.</span></span> <span data-ttu-id="c5363-181">I valori sono `None`, `System` e `Custom`.</span><span class="sxs-lookup"><span data-stu-id="c5363-181">The values are `None`, `System`, and `Custom`.</span></span> <span data-ttu-id="c5363-182">Per altre informazioni sull'interpretazione di queste proprietà, vedere [utilizzando non recapitabili per gestire errori di trasferimento dei messaggi](../../../../docs/framework/wcf/feature-details/using-dead-letter-queues-to-handle-message-transfer-failures.md)</span><span class="sxs-lookup"><span data-stu-id="c5363-182">For more information about the interpretation of these properties, see [Using Dead-Letter Queues to Handle Message Transfer Failures](../../../../docs/framework/wcf/feature-details/using-dead-letter-queues-to-handle-message-transfer-failures.md)</span></span>  
  
-   `CustomDeadLetterQueue`<span data-ttu-id="c5363-183">: Questa proprietà è l'indirizzo di Uniform Resource Identifier (URI) della coda recapitabili specifiche dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c5363-183">: This property is the Uniform Resource Identifier (URI) address of the application-specific dead-letter queue.</span></span> <span data-ttu-id="c5363-184">Questa operazione è necessaria se `DeadLetterQueue`.</span><span class="sxs-lookup"><span data-stu-id="c5363-184">This is required if `DeadLetterQueue`.</span></span>`Custom` <span data-ttu-id="c5363-185">è stato scelto.</span><span class="sxs-lookup"><span data-stu-id="c5363-185">is chosen.</span></span>  
  
#### <a name="poison-message-handling-properties"></a><span data-ttu-id="c5363-186">Proprietà di gestione dei messaggi non elaborabili</span><span class="sxs-lookup"><span data-stu-id="c5363-186">Poison Message Handling properties</span></span>  
 <span data-ttu-id="c5363-187">Quando il servizio legge un messaggio dalla coda di destinazione in una transazione, è possibile che non riesca a elaborarlo per vari motivi.</span><span class="sxs-lookup"><span data-stu-id="c5363-187">When the service reads messages from the target queue under a transaction, the service may fail to process the message for various reasons.</span></span> <span data-ttu-id="c5363-188">Il messaggio viene quindi reinserito nella coda per essere nuovamente letto.</span><span class="sxs-lookup"><span data-stu-id="c5363-188">The message is then put back into the queue to be read again.</span></span> <span data-ttu-id="c5363-189">Per gestire messaggi la cui elaborazione ripetutamente esito negativo, è possibile configurare nell'associazione un set di proprietà di gestione dei messaggi non elaborabili.</span><span class="sxs-lookup"><span data-stu-id="c5363-189">To deal with messages that fail repeatedly, a set of poison-message handling properties can be configured in the binding.</span></span> <span data-ttu-id="c5363-190">Sono disponibili quattro proprietà: `ReceiveRetryCount`, `MaxRetryCycles`, `RetryCycleDelay` e `ReceiveErrorHandling`.</span><span class="sxs-lookup"><span data-stu-id="c5363-190">There are four properties: `ReceiveRetryCount`, `MaxRetryCycles`, `RetryCycleDelay`, and `ReceiveErrorHandling`.</span></span> <span data-ttu-id="c5363-191">Per altre informazioni su queste proprietà, vedere [messaggi non elaborabili](../../../../docs/framework/wcf/feature-details/poison-message-handling.md).</span><span class="sxs-lookup"><span data-stu-id="c5363-191">For more information about these properties, see [Poison Message Handling](../../../../docs/framework/wcf/feature-details/poison-message-handling.md).</span></span>  
  
#### <a name="security-properties"></a><span data-ttu-id="c5363-192">Proprietà di sicurezza</span><span class="sxs-lookup"><span data-stu-id="c5363-192">Security Properties</span></span>  
 <span data-ttu-id="c5363-193">MSMQ espone il proprio modello di sicurezza, che prevede ad esempio l'applicazione di elenchi di controllo di accesso (ACL) su una coda o l'invio di messaggi autenticati.</span><span class="sxs-lookup"><span data-stu-id="c5363-193">MSMQ exposes its own security model, such as access control lists (ACLs) on a queue or sending authenticated messages.</span></span> <span data-ttu-id="c5363-194">La classe `NetMsmqBinding` espone queste proprietà di sicurezza come parte delle proprie impostazioni di sicurezza del trasporto.</span><span class="sxs-lookup"><span data-stu-id="c5363-194">The `NetMsmqBinding` exposes these security properties as part of its transport security settings.</span></span> <span data-ttu-id="c5363-195">Nell'associazione sono presenti due proprietà per la sicurezza del trasporto: `MsmqAuthenticationMode` e `MsmqProtectionLevel`.</span><span class="sxs-lookup"><span data-stu-id="c5363-195">There are two properties in the binding for transport security: `MsmqAuthenticationMode` and `MsmqProtectionLevel`.</span></span> <span data-ttu-id="c5363-196">Le impostazioni in queste proprietà dipendono dalla modalità di configurazione di MSMQ.</span><span class="sxs-lookup"><span data-stu-id="c5363-196">Settings in these properties depend on how MSMQ is configured.</span></span> <span data-ttu-id="c5363-197">Per altre informazioni, vedere [protezione dei messaggi mediante protezione del trasporto](../../../../docs/framework/wcf/feature-details/securing-messages-using-transport-security.md).</span><span class="sxs-lookup"><span data-stu-id="c5363-197">For more information, see [Securing Messages Using Transport Security](../../../../docs/framework/wcf/feature-details/securing-messages-using-transport-security.md).</span></span>  
  
 <span data-ttu-id="c5363-198">Oltre alla sicurezza del trasporto, il messaggio SOAP effettivo stesso può essere protetto usando la sicurezza dei messaggi.</span><span class="sxs-lookup"><span data-stu-id="c5363-198">In addition to transport security, the actual SOAP message itself can be secured using message security.</span></span> <span data-ttu-id="c5363-199">Per altre informazioni, vedere [protezione dei messaggi tramite sicurezza dei messaggi](../../../../docs/framework/wcf/feature-details/securing-messages-using-message-security.md).</span><span class="sxs-lookup"><span data-stu-id="c5363-199">For more information, see [Securing Messages Using Message Security](../../../../docs/framework/wcf/feature-details/securing-messages-using-message-security.md).</span></span>  
  
 `MsmqTransportSecurity` <span data-ttu-id="c5363-200">espone inoltre due proprietà, `MsmqEncryptionAlgorithm` e `MsmqHashAlgorithm`.</span><span class="sxs-lookup"><span data-stu-id="c5363-200">also exposes two properties, `MsmqEncryptionAlgorithm` and `MsmqHashAlgorithm`.</span></span> <span data-ttu-id="c5363-201">Si tratta di enumerazioni di algoritmi diversi da scegliere per la crittografia del trasferimento da coda a coda di messaggi e l'hash delle firme.</span><span class="sxs-lookup"><span data-stu-id="c5363-201">These are enumerations of different algorithms to choose for queue-to-queue transfer encryption of messages and hashing of the signatures.</span></span>  
  
#### <a name="other-properties"></a><span data-ttu-id="c5363-202">Altre proprietà</span><span class="sxs-lookup"><span data-stu-id="c5363-202">Other Properties</span></span>  
 <span data-ttu-id="c5363-203">Oltre alle proprietà precedenti, le altre proprietà specifiche di MSMQ esposte nell'associazione includono:</span><span class="sxs-lookup"><span data-stu-id="c5363-203">In addition to the preceding properties, other MSMQ-specific properties exposed in the binding include:</span></span>  
  
-   `UseSourceJournal`<span data-ttu-id="c5363-204">: Una proprietà per indicare tale inserimento nel journal di origine è attivata.</span><span class="sxs-lookup"><span data-stu-id="c5363-204">: A property to indicate that source journaling is turned on.</span></span> <span data-ttu-id="c5363-205">L'inserimento nel journal di origine è una funzionalità MSMQ che consente di tenere traccia dei messaggi correttamente trasmessi dalla coda di trasmissione.</span><span class="sxs-lookup"><span data-stu-id="c5363-205">Source journaling is an MSMQ feature that keeps track of messages that have been successfully transmitted from the transmission queue.</span></span>  
  
-   `UseMsmqTracing`<span data-ttu-id="c5363-206">: Una proprietà per indicare che la traccia MSMQ è attivata.</span><span class="sxs-lookup"><span data-stu-id="c5363-206">: A property to indicate that MSMQ tracing is turned on.</span></span> <span data-ttu-id="c5363-207">La traccia MSMQ consente di inviare messaggi di rapporto a una coda dei rapporti ogni volta che un messaggio lascia o arriva in un computer che ospita un gestore code MSMQ.</span><span class="sxs-lookup"><span data-stu-id="c5363-207">MSMQ tracing sends report messages to a report queue each time a message leaves or arrives at a machine hosting an MSMQ queue manager.</span></span>  
  
-   `QueueTransferProtocol`<span data-ttu-id="c5363-208">: Enumerazione del protocollo da usare per i trasferimenti di messaggi della coda a coda.</span><span class="sxs-lookup"><span data-stu-id="c5363-208">: An enumeration of the protocol to use for queue-to-queue message transfers.</span></span> <span data-ttu-id="c5363-209">MSMQ implementa un protocollo di trasferimento da coda a coda nativo e un protocollo basato su SOAP denominato SRMP (SOAP Reliable Messaging Protocol).</span><span class="sxs-lookup"><span data-stu-id="c5363-209">MSMQ implements a native queue-to-queue transfer protocol and a SOAP-based protocol called SOAP Reliable Messaging Protocol (SRMP).</span></span> <span data-ttu-id="c5363-210">SRMP viene usato quando si usa il trasporto HTTP per i trasferimenti da coda a coda.</span><span class="sxs-lookup"><span data-stu-id="c5363-210">SRMP is used when using HTTP transport for queue-to-queue transfers.</span></span> <span data-ttu-id="c5363-211">Viene invece usato il protocollo SRMP protetto quando si usa HTTPS per i trasferimenti da coda a coda.</span><span class="sxs-lookup"><span data-stu-id="c5363-211">SRMP secure is used when using HTTPS for queue-to-queue transfers.</span></span>  
  
-   `UseActiveDirectory`<span data-ttu-id="c5363-212">: Valore booleano per indicare se è necessario usare Active Directory per la risoluzione degli indirizzi di coda.</span><span class="sxs-lookup"><span data-stu-id="c5363-212">: A Boolean value to indicate whether the Active Directory must be used for queue address resolution.</span></span> <span data-ttu-id="c5363-213">Per impostazione predefinita, questa funzionalità è disattivata.</span><span class="sxs-lookup"><span data-stu-id="c5363-213">By default, this is off.</span></span> <span data-ttu-id="c5363-214">Per altre informazioni, vedere [gli endpoint di servizio e indirizzamento delle code](../../../../docs/framework/wcf/feature-details/service-endpoints-and-queue-addressing.md).</span><span class="sxs-lookup"><span data-stu-id="c5363-214">For more information, see [Service Endpoints and Queue Addressing](../../../../docs/framework/wcf/feature-details/service-endpoints-and-queue-addressing.md).</span></span>  
  
### <a name="msmqintegrationbinding"></a><span data-ttu-id="c5363-215">MsmqIntegrationBinding</span><span class="sxs-lookup"><span data-stu-id="c5363-215">MsmqIntegrationBinding</span></span>  
 <span data-ttu-id="c5363-216">Il `MsmqIntegrationBinding` viene usato quando si desidera che un endpoint WCF per comunicare con un'applicazione MSMQ esistente scritta in C, C++, COM o System.Messaging APIs.</span><span class="sxs-lookup"><span data-stu-id="c5363-216">The `MsmqIntegrationBinding` is used when you want a WCF endpoint to communicate with an existing MSMQ application written in C, C++, COM, or System.Messaging APIs.</span></span>  
  
 <span data-ttu-id="c5363-217">Le proprietà dell'associazione sono le stesse di `NetMsmqBinding`.</span><span class="sxs-lookup"><span data-stu-id="c5363-217">The binding properties are the same as for `NetMsmqBinding`.</span></span> <span data-ttu-id="c5363-218">Esistono tuttavia le differenze seguenti:</span><span class="sxs-lookup"><span data-stu-id="c5363-218">However, the following differences apply:</span></span>  
  
-   <span data-ttu-id="c5363-219">Il contratto dell'operazione per `MsmqIntegrationBinding` si limita ad accettare un solo parametro di tipo <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601>, in cui il parametro di tipo è il tipo di corpo.</span><span class="sxs-lookup"><span data-stu-id="c5363-219">The operation contract for `MsmqIntegrationBinding` is restricted to taking a single parameter of type <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601> where the type parameter is the body type.</span></span>  
  
-   <span data-ttu-id="c5363-220">Molte delle proprietà dei messaggi native MSMQ vengono esposte in <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601> per l'uso.</span><span class="sxs-lookup"><span data-stu-id="c5363-220">Much of MSMQ native message properties are exposed in the <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601> for use.</span></span>  
  
-   <span data-ttu-id="c5363-221">Per agevolare la serializzazione e la deserializzazione del corpo del messaggio vengono forniti serializzatori XML e ActiveX.</span><span class="sxs-lookup"><span data-stu-id="c5363-221">To help with serialization and deserialization of the message body, serializers such as XML and ActiveX are provided.</span></span>  
  
### <a name="sample-code"></a><span data-ttu-id="c5363-222">Codice di esempio</span><span class="sxs-lookup"><span data-stu-id="c5363-222">Sample Code</span></span>  
 <span data-ttu-id="c5363-223">Per istruzioni dettagliate su come scrivere servizi WCF che usano MSMQ, vedere gli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="c5363-223">For step by step instructions on how to write WCF services that use MSMQ see the following topics:</span></span>  
  
-   [<span data-ttu-id="c5363-224">Procedura: Scambiare messaggi con endpoint WCF e con applicazioni di accodamento dei messaggi</span><span class="sxs-lookup"><span data-stu-id="c5363-224">How to: Exchange Messages with WCF Endpoints and Message Queuing Applications</span></span>](../../../../docs/framework/wcf/feature-details/how-to-exchange-messages-with-wcf-endpoints-and-message-queuing-applications.md)  
  
-   [<span data-ttu-id="c5363-225">Procedura: Scambiare messaggi in coda con endpoint WCF</span><span class="sxs-lookup"><span data-stu-id="c5363-225">How to: Exchange Queued Messages with WCF Endpoints</span></span>](../../../../docs/framework/wcf/feature-details/how-to-exchange-queued-messages-with-wcf-endpoints.md)  
  
 <span data-ttu-id="c5363-226">Per un esempio di codice completo in cui viene illustrato l'uso di MSMQ in WCF, vedere gli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="c5363-226">For a completed code sample illustrating the use of MSMQ in WCF see the following topics:</span></span>  
  
-   [<span data-ttu-id="c5363-227">Associazioni MSMQ transazionali</span><span class="sxs-lookup"><span data-stu-id="c5363-227">Transacted MSMQ Binding</span></span>](../../../../docs/framework/wcf/samples/transacted-msmq-binding.md)  
  
-   [<span data-ttu-id="c5363-228">Comunicazione volatile in coda</span><span class="sxs-lookup"><span data-stu-id="c5363-228">Volatile Queued Communication</span></span>](../../../../docs/framework/wcf/samples/volatile-queued-communication.md)  
  
-   [<span data-ttu-id="c5363-229">Code di messaggi non recapitabili</span><span class="sxs-lookup"><span data-stu-id="c5363-229">Dead Letter Queues</span></span>](../../../../docs/framework/wcf/samples/dead-letter-queues.md)  
  
-   [<span data-ttu-id="c5363-230">Sessioni e code</span><span class="sxs-lookup"><span data-stu-id="c5363-230">Sessions and Queues</span></span>](../../../../docs/framework/wcf/samples/sessions-and-queues.md)  
  
-   [<span data-ttu-id="c5363-231">Comunicazione bidirezionale</span><span class="sxs-lookup"><span data-stu-id="c5363-231">Two-Way Communication</span></span>](../../../../docs/framework/wcf/samples/two-way-communication.md) 
  
-   [<span data-ttu-id="c5363-232">SRMP</span><span class="sxs-lookup"><span data-stu-id="c5363-232">SRMP</span></span>](../../../../docs/framework/wcf/samples/srmp.md)  
  
-   [<span data-ttu-id="c5363-233">Sicurezza dei messaggi nell'accodamento messaggi</span><span class="sxs-lookup"><span data-stu-id="c5363-233">Message Security over Message Queuing</span></span>](../../../../docs/framework/wcf/samples/message-security-over-message-queuing.md)  
  
## <a name="see-also"></a><span data-ttu-id="c5363-234">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="c5363-234">See also</span></span>

- [<span data-ttu-id="c5363-235">Mapping fra gli endpoint di servizio e l'indirizzamento delle code</span><span class="sxs-lookup"><span data-stu-id="c5363-235">Service Endpoints and Queue Addressing</span></span>](../../../../docs/framework/wcf/feature-details/service-endpoints-and-queue-addressing.md)
- [<span data-ttu-id="c5363-236">Sito Web che ospita un'applicazione in coda</span><span class="sxs-lookup"><span data-stu-id="c5363-236">Web Hosting a Queued Application</span></span>](../../../../docs/framework/wcf/feature-details/web-hosting-a-queued-application.md)
