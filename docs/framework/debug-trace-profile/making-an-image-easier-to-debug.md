---
title: Semplificazione un'immagine eseguire il debug in .NET
description: Informazioni su come configurare un'immagine eseguibile per semplificare il debug utilizzando l'IDE opzioni e le opzioni della riga di comando.
ms.date: 08/30/2018
helpviewer_keywords:
- images [.NET Framework], debugging
- executable image for debugging
- debugging [.NET Framework], executable images for
ms.assetid: 7d90ea7a-150f-4f97-98a7-f9c26541b9a3
author: mairaw
ms.author: mairaw
ms.openlocfilehash: 5bab707afb059d4fcbd46a9ee54edead991be523
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/23/2019
ms.locfileid: "61754219"
---
# <a name="making-an-image-easier-to-debug-in-net"></a><span data-ttu-id="50bf6-103">Semplificazione un'immagine eseguire il debug in .NET</span><span class="sxs-lookup"><span data-stu-id="50bf6-103">Making an image easier to debug in .NET</span></span>

<span data-ttu-id="50bf6-104">Quando si compila codice non gestito, è possibile configurare un'immagine eseguibile per il debug impostando le opzioni dell'IDE o della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="50bf6-104">When compiling unmanaged code, you can configure an executable image for debugging by setting IDE switches or command-line options.</span></span> <span data-ttu-id="50bf6-105">Ad esempio, è possibile usare l'opzione della riga di comando /**Zi** in Visual C++ per richiedere di generare file di simboli di debug (file con estensione pdb).</span><span class="sxs-lookup"><span data-stu-id="50bf6-105">For example, you can use the /**Zi** command-line option in Visual C++ to ask it to emit debug symbol files (file extension .pdb).</span></span> <span data-ttu-id="50bf6-106">In modo analogo, l'opzione della riga di comando /**Od** indica al compilatore di disabilitare l'ottimizzazione.</span><span class="sxs-lookup"><span data-stu-id="50bf6-106">Similarly, the /**Od** command-line option tells the compiler to disable optimization.</span></span> <span data-ttu-id="50bf6-107">Il codice risultante è molto più lento, ma è più facile eseguire il debug, questo non è necessario.</span><span class="sxs-lookup"><span data-stu-id="50bf6-107">The resulting code runs more slowly, but it's easier to debug, should this be necessary.</span></span>

<span data-ttu-id="50bf6-108">Quando la compilazione di .NET Framework, codice gestito, i compilatori come Visual C++, Visual Basic e c# compilano il programma di origine in Microsoft intermediate language (MSIL).</span><span class="sxs-lookup"><span data-stu-id="50bf6-108">When compiling .NET Framework managed code, compilers such as Visual C++, Visual Basic, and C# compile their source program into Microsoft intermediate language (MSIL).</span></span> <span data-ttu-id="50bf6-109">MSIL viene quindi compilato tramite JIT, appena prima dell'esecuzione, in codice macchina nativo.</span><span class="sxs-lookup"><span data-stu-id="50bf6-109">MSIL is then JIT-compiled, just before execution, into native machine code.</span></span> <span data-ttu-id="50bf6-110">Come per il codice non gestito, è possibile configurare un'immagine eseguibile per il debug impostando le opzioni dell'IDE o della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="50bf6-110">As with unmanaged code, you can configure an executable image for debugging by setting IDE switches or command-line options.</span></span> <span data-ttu-id="50bf6-111">È anche possibile configurare la compilazione JIT per il debug in modo analogo.</span><span class="sxs-lookup"><span data-stu-id="50bf6-111">You can also configure the JIT compilation for debugging in much the same way.</span></span>

<span data-ttu-id="50bf6-112">Questa configurazione JIT presenta due aspetti:</span><span class="sxs-lookup"><span data-stu-id="50bf6-112">This JIT configuration has two aspects:</span></span>

- <span data-ttu-id="50bf6-113">È possibile richiedere al compilatore JIT di generare informazioni di rilevamento.</span><span class="sxs-lookup"><span data-stu-id="50bf6-113">You can request the JIT compiler to generate tracking information.</span></span> <span data-ttu-id="50bf6-114">In questo modo il debugger ha la possibilità di abbinare una catena di codice MSIL alla controparte in codice macchina e di tenere traccia della posizione di archiviazione delle variabili locali e degli argomenti delle funzioni.</span><span class="sxs-lookup"><span data-stu-id="50bf6-114">This makes it possible for the debugger to match up a chain of MSIL with its machine code counterpart, and to track where local variables and function arguments are stored.</span></span> <span data-ttu-id="50bf6-115">A partire da .NET Framework versione 2.0, il compilatore JIT genera sempre le informazioni di rilevamento, in modo che non è necessario per la richiesta.</span><span class="sxs-lookup"><span data-stu-id="50bf6-115">Starting with the .NET Framework version 2.0, the JIT compiler always generates tracking information, so there is no need to request it.</span></span>

- <span data-ttu-id="50bf6-116">È possibile richiedere al compilatore JIT di non ottimizzare il codice macchina risultante.</span><span class="sxs-lookup"><span data-stu-id="50bf6-116">You can request the JIT compiler to not optimize the resulting machine code.</span></span>

<span data-ttu-id="50bf6-117">In genere, il compilatore che genera il codice MSIL imposta queste opzioni del compilatore JIT in modo appropriato, in base alle opzioni dell'IDE o della riga di comando si specifica, ad esempio, /**Od**.</span><span class="sxs-lookup"><span data-stu-id="50bf6-117">Normally, the compiler that generates the MSIL sets these JIT compiler options appropriately, based upon the IDE switches or command-line options you specify, for example, /**Od**.</span></span>

<span data-ttu-id="50bf6-118">In alcuni casi, può essere necessario modificare il comportamento del compilatore JIT in modo che sia più semplice eseguire il debug del codice macchina generato.</span><span class="sxs-lookup"><span data-stu-id="50bf6-118">In some cases, you might want to change the behavior of the JIT compiler so that the machine code it generates is easier to debug.</span></span> <span data-ttu-id="50bf6-119">Ad esempio, si potrebbero generare informazioni di rilevamento JIT per una build finale o un'ottimizzazione dei controlli.</span><span class="sxs-lookup"><span data-stu-id="50bf6-119">For example, you might want to generate JIT tracking information for a retail build or control optimization.</span></span> <span data-ttu-id="50bf6-120">È possibile farlo con un file di inizializzazione (INI).</span><span class="sxs-lookup"><span data-stu-id="50bf6-120">You can do so with an initialization (.ini) file.</span></span>

<span data-ttu-id="50bf6-121">Ad esempio, se l'assembly che si desidera eseguire il debug viene chiamato *MyApp.exe*, è possibile creare un file di testo denominato *MyApp*, nella stessa cartella del *MyApp.exe*, che contiene Queste tre righe:</span><span class="sxs-lookup"><span data-stu-id="50bf6-121">For example, if the assembly you want to debug is called *MyApp.exe*, then you can create a text file named *MyApp.ini*, in the same folder as *MyApp.exe*, which contains these three lines:</span></span>

```ini
[.NET Framework Debugging Control]
GenerateTrackingInfo=1
AllowOptimize=0
```

<span data-ttu-id="50bf6-122">È possibile impostare il valore di ogni opzione su 0 o 1 e per qualsiasi opzione assente verrà usato il valore predefinito 0.</span><span class="sxs-lookup"><span data-stu-id="50bf6-122">You can set the value of each option to 0 or 1, and any absent option defaults to 0.</span></span> <span data-ttu-id="50bf6-123">L'impostazione di `GenerateTrackingInfo` su 1 e di `AllowOptimize` su 0 consente di semplificare al massimo il debug.</span><span class="sxs-lookup"><span data-stu-id="50bf6-123">Setting `GenerateTrackingInfo` to 1 and `AllowOptimize` to 0 provides the easiest debugging.</span></span>

<span data-ttu-id="50bf6-124">A partire da .NET Framework versione 2.0, il compilatore JIT genera sempre le informazioni di rilevamento indipendentemente dal valore per `GenerateTrackingInfo`; tuttavia, il `AllowOptimize` valore ha ancora effetto.</span><span class="sxs-lookup"><span data-stu-id="50bf6-124">Starting with the .NET Framework version 2.0, the JIT compiler always generates tracking information regardless of the value for `GenerateTrackingInfo`; however, the `AllowOptimize` value still has an effect.</span></span> <span data-ttu-id="50bf6-125">Quando si usa [Ngen.exe (generatore di immagini native)](../../../docs/framework/tools/ngen-exe-native-image-generator.md) per precompilare l'immagine nativa senza ottimizzazione, il file INI deve essere presente nella cartella di destinazione con `AllowOptimize=0` quando viene eseguito Ngen.exe.</span><span class="sxs-lookup"><span data-stu-id="50bf6-125">When using the [Ngen.exe (Native Image Generator)](../../../docs/framework/tools/ngen-exe-native-image-generator.md) to precompile the native image without optimization, the .ini file must be present in the target folder with `AllowOptimize=0` when Ngen.exe executes.</span></span> <span data-ttu-id="50bf6-126">Se è stato precompilato un assembly senza ottimizzazione, è necessario rimuovere il codice precompilato usando NGen.exe **/Uninstall** opzione prima di eseguire nuovamente Ngen.exe per precompilare il codice ottimizzato.</span><span class="sxs-lookup"><span data-stu-id="50bf6-126">If you have precompiled an assembly without optimization, you must remove the precompiled code using NGen.exe **/uninstall** option before rerunning Ngen.exe to precompile the code as optimized.</span></span> <span data-ttu-id="50bf6-127">Se il file ini non è presente nella cartella, per impostazione predefinita Ngen.exe precompila il codice come ottimizzato.</span><span class="sxs-lookup"><span data-stu-id="50bf6-127">If the .ini file isn't present in the folder, by default Ngen.exe precompiles the code as optimized.</span></span>

<span data-ttu-id="50bf6-128"><xref:System.Diagnostics.DebuggableAttribute?displayProperty=nameWithType> controlla le impostazioni per un assembly.</span><span class="sxs-lookup"><span data-stu-id="50bf6-128">The <xref:System.Diagnostics.DebuggableAttribute?displayProperty=nameWithType> controls the settings for an assembly.</span></span> <span data-ttu-id="50bf6-129">**DebuggableAttribute** include due campi che controllano se il compilatore JIT deve ottimizzare e/o generare informazioni di rilevamento.</span><span class="sxs-lookup"><span data-stu-id="50bf6-129">**DebuggableAttribute** includes two fields that control whether the JIT compiler should optimize and/or generate tracking information.</span></span> <span data-ttu-id="50bf6-130">A partire da .NET Framework versione 2.0, il compilatore JIT genera sempre le informazioni di rilevamento.</span><span class="sxs-lookup"><span data-stu-id="50bf6-130">Starting with the .NET Framework version 2.0, the JIT compiler always generates tracking information.</span></span>

<span data-ttu-id="50bf6-131">Per una build finale, i compilatori non impostano eventuali **DebuggableAttribute**.</span><span class="sxs-lookup"><span data-stu-id="50bf6-131">For a retail build, compilers don't set any **DebuggableAttribute**.</span></span> <span data-ttu-id="50bf6-132">Per impostazione predefinita, il compilatore JIT genera prestazioni più elevate, più difficile il debug del codice macchina.</span><span class="sxs-lookup"><span data-stu-id="50bf6-132">By default, the JIT compiler generates the highest performance, hardest to debug machine code.</span></span> <span data-ttu-id="50bf6-133">L'abilitazione del rilevamento JIT riduce leggermente le prestazioni e la disabilitazione dell'ottimizzazione le riduce notevolmente.</span><span class="sxs-lookup"><span data-stu-id="50bf6-133">Enabling JIT tracking lowers performance a little, and disabling optimization lowers performance a lot.</span></span>

<span data-ttu-id="50bf6-134">**DebuggableAttribute** si applica a un intero assembly per volta, non ai singoli moduli all'interno dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="50bf6-134">The **DebuggableAttribute** applies to a whole assembly at a time, not to individual modules within the assembly.</span></span> <span data-ttu-id="50bf6-135">Gli strumenti di sviluppo devono quindi associare gli attributi personalizzati al token dei metadati di assembly, se un assembly è già stato creato, o alla classe chiamata **System.Runtime.CompilerServices.AssemblyAttributesGoHere**.</span><span class="sxs-lookup"><span data-stu-id="50bf6-135">Development tools must therefore attach custom attributes to the assembly metadata token, if an assembly has already been created, or to the class called **System.Runtime.CompilerServices.AssemblyAttributesGoHere**.</span></span> <span data-ttu-id="50bf6-136">Lo strumento ALink promuove quindi questi **DebuggableAttribute** attributi da ogni modulo all'assembly diventano una parte di.</span><span class="sxs-lookup"><span data-stu-id="50bf6-136">The ALink tool then promotes these **DebuggableAttribute** attributes from each module to the assembly they become a part of.</span></span> <span data-ttu-id="50bf6-137">Se si verifica un conflitto, l'operazione ALink avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="50bf6-137">If there's a conflict, the ALink operation fails.</span></span>

> [!NOTE]
> <span data-ttu-id="50bf6-138">Nella versione 1.0 di .NET Framework, il compilatore Microsoft Visual C++ aggiunge **DebuggableAttribute** quando vengono specificate le opzioni del compilatore **/clr** e **/Zi**.</span><span class="sxs-lookup"><span data-stu-id="50bf6-138">In version 1.0 of the .NET Framework, the Microsoft Visual C++ compiler adds the **DebuggableAttribute** when the **/clr** and **/Zi** compiler options are specified.</span></span> <span data-ttu-id="50bf6-139">Nella versione 1.1 di .NET Framework, è necessario aggiungere il **DebuggableAttribute** manualmente nel codice o utilizzare il **/ASSEMBLYDEBUG** l'opzione del linker.</span><span class="sxs-lookup"><span data-stu-id="50bf6-139">In version 1.1 of the .NET Framework, you must either add the **DebuggableAttribute** manually in your code or use the **/ASSEMBLYDEBUG** linker option.</span></span>

## <a name="see-also"></a><span data-ttu-id="50bf6-140">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="50bf6-140">See also</span></span>

- [<span data-ttu-id="50bf6-141">Debug, traccia e profilatura</span><span class="sxs-lookup"><span data-stu-id="50bf6-141">Debugging, Tracing, and Profiling</span></span>](../../../docs/framework/debug-trace-profile/index.md)
- [<span data-ttu-id="50bf6-142">Abilitazione del debug ad associazione JIT</span><span class="sxs-lookup"><span data-stu-id="50bf6-142">Enabling JIT-Attach Debugging</span></span>](../../../docs/framework/debug-trace-profile/enabling-jit-attach-debugging.md)
- <span data-ttu-id="50bf6-143">[Abilitazione della funzione di profilatura](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/s5ec0es1(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="50bf6-143">[Enabling Profiling](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/s5ec0es1(v=vs.100))</span></span>
