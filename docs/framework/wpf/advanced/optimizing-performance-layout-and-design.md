---
title: 'Ottimizzazione delle prestazioni: Layout e progettazione'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- layout [WPF], optimizing performance
- design considerations [WPF]
- layout pass [WPF]
ms.assetid: 005f4cda-a849-448b-916b-38d14d9a96fe
ms.openlocfilehash: 8a76dd5de9f374d77345eeab3d259624546fed7c
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 04/23/2019
ms.locfileid: "62050220"
---
# <a name="optimizing-performance-layout-and-design"></a><span data-ttu-id="6ec57-102">Ottimizzazione delle prestazioni: Layout e progettazione</span><span class="sxs-lookup"><span data-stu-id="6ec57-102">Optimizing Performance: Layout and Design</span></span>
<span data-ttu-id="6ec57-103">La progettazione dell'applicazione [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] può influire sulle relative prestazioni, poiché crea un sovraccarico non necessario durante il calcolo del layout e la convalida dei riferimenti agli oggetti.</span><span class="sxs-lookup"><span data-stu-id="6ec57-103">The design of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application can impact its performance by creating unnecessary overhead in calculating layout and validating object references.</span></span> <span data-ttu-id="6ec57-104">La costruzione di oggetti, soprattutto in fase di runtime, può influire sulle caratteristiche di prestazioni dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="6ec57-104">The construction of objects, particularly at run time, can affect the performance characteristics of your application.</span></span>  
  
 <span data-ttu-id="6ec57-105">Questo argomento offre utili suggerimenti per il miglioramento delle prestazioni in queste aree.</span><span class="sxs-lookup"><span data-stu-id="6ec57-105">This topic provides performance recommendations in these areas.</span></span>  
  
## <a name="layout"></a><span data-ttu-id="6ec57-106">Layout</span><span class="sxs-lookup"><span data-stu-id="6ec57-106">Layout</span></span>  
 <span data-ttu-id="6ec57-107">Il termine "passaggio di layout" descrive il processo di misurazione e disposizione dei membri di un <xref:System.Windows.Controls.Panel>-insieme di elementi figlio e di disegno sullo schermo dell'oggetto derivato.</span><span class="sxs-lookup"><span data-stu-id="6ec57-107">The term "layout pass" describes the process of measuring and arranging the members of a <xref:System.Windows.Controls.Panel>-derived object's collection of children, and then drawing them onscreen.</span></span> <span data-ttu-id="6ec57-108">Il passaggio di layout è un processo molto complesso dal punto di vista matematico: più alto è il numero di elementi figlio presenti nella raccolta, maggiore è il numero di calcoli necessari.</span><span class="sxs-lookup"><span data-stu-id="6ec57-108">The layout pass is a mathematically-intensive process—the larger the number of children in the collection, the greater the number of calculations required.</span></span> <span data-ttu-id="6ec57-109">Ad esempio, ogni volta che un elemento figlio <xref:System.Windows.UIElement> oggetto nella raccolta cambia posizione, ha la possibilità di attivare un nuovo passaggio dal sistema di layout.</span><span class="sxs-lookup"><span data-stu-id="6ec57-109">For example, each time a child <xref:System.Windows.UIElement> object in the collection changes its position, it has the potential to trigger a new pass by the layout system.</span></span> <span data-ttu-id="6ec57-110">Data la stretta correlazione tra le caratteristiche dell'oggetto e il comportamento del layout, è importante capire i tipi di eventi che possono richiamare il sistema di layout.</span><span class="sxs-lookup"><span data-stu-id="6ec57-110">Because of the close relationship between object characteristics and layout behavior, it's important to understand the type of events that can invoke the layout system.</span></span> <span data-ttu-id="6ec57-111">Le prestazioni dell'applicazione risulteranno migliori se si riuscirà a ridurre al massimo le chiamate non necessarie al passaggio di layout.</span><span class="sxs-lookup"><span data-stu-id="6ec57-111">Your application will perform better by reducing as much as possible any unnecessary invocations of the layout pass.</span></span>  
  
 <span data-ttu-id="6ec57-112">Per ogni membro figlio di una raccolta vengono completati due passaggi: un passaggio di misurazione e uno di disposizione.</span><span class="sxs-lookup"><span data-stu-id="6ec57-112">The layout system completes two passes for each child member in a collection: a measure pass, and an arrange pass.</span></span> <span data-ttu-id="6ec57-113">Ogni oggetto figlio offre la propria implementazione sottoposta a override del <xref:System.Windows.UIElement.Measure%2A> e <xref:System.Windows.UIElement.Arrange%2A> metodi per fornire il proprio comportamento di layout specifico.</span><span class="sxs-lookup"><span data-stu-id="6ec57-113">Each child object provides its own overridden implementation of the <xref:System.Windows.UIElement.Measure%2A> and <xref:System.Windows.UIElement.Arrange%2A> methods in order to provide its own specific layout behavior.</span></span> <span data-ttu-id="6ec57-114">Nella forma più semplice, il layout è un sistema ricorsivo che fa sì che un elemento venga ridimensionato, posizionato e disegnato sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="6ec57-114">At its simplest, layout is a recursive system that leads to an element being sized, positioned, and drawn onscreen.</span></span>  
  
- <span data-ttu-id="6ec57-115">Un elemento figlio <xref:System.Windows.UIElement> oggetto inizia il processo di layout con la misurazione delle relative proprietà principali.</span><span class="sxs-lookup"><span data-stu-id="6ec57-115">A child <xref:System.Windows.UIElement> object begins the layout process by first having its core properties measured.</span></span>  
  
- <span data-ttu-id="6ec57-116">L'oggetto <xref:System.Windows.FrameworkElement> le proprietà correlate alle dimensioni, ad esempio <xref:System.Windows.FrameworkElement.Width%2A>, <xref:System.Windows.FrameworkElement.Height%2A>, e <xref:System.Windows.FrameworkElement.Margin%2A>, vengono valutati.</span><span class="sxs-lookup"><span data-stu-id="6ec57-116">The object's <xref:System.Windows.FrameworkElement> properties that are related to size, such as <xref:System.Windows.FrameworkElement.Width%2A>, <xref:System.Windows.FrameworkElement.Height%2A>, and <xref:System.Windows.FrameworkElement.Margin%2A>, are evaluated.</span></span>  
  
- <span data-ttu-id="6ec57-117"><xref:System.Windows.Controls.Panel>-viene applicata logica specifica, ad esempio la <xref:System.Windows.Controls.DockPanel.Dock%2A> proprietà del <xref:System.Windows.Controls.DockPanel>, o il <xref:System.Windows.Controls.StackPanel.Orientation%2A> proprietà del <xref:System.Windows.Controls.StackPanel>.</span><span class="sxs-lookup"><span data-stu-id="6ec57-117"><xref:System.Windows.Controls.Panel>-specific logic is applied, such as the <xref:System.Windows.Controls.DockPanel.Dock%2A> property of the <xref:System.Windows.Controls.DockPanel>, or the <xref:System.Windows.Controls.StackPanel.Orientation%2A> property of the <xref:System.Windows.Controls.StackPanel>.</span></span>  
  
- <span data-ttu-id="6ec57-118">Il contenuto viene disposto, o posizionato, dopo la misurazione di tutti gli oggetti figlio.</span><span class="sxs-lookup"><span data-stu-id="6ec57-118">Content is arranged, or positioned, after all child objects have been measured.</span></span>  
  
- <span data-ttu-id="6ec57-119">La raccolta di oggetti figlio viene disegnata sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="6ec57-119">The collection of child objects is drawn to the screen.</span></span>  
  
 <span data-ttu-id="6ec57-120">Il passaggio di layout viene nuovamente richiamato qualora si verifichi una delle azioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="6ec57-120">The layout pass process is invoked again if any of the following actions occur:</span></span>  
  
- <span data-ttu-id="6ec57-121">Un oggetto figlio viene aggiunto alla raccolta.</span><span class="sxs-lookup"><span data-stu-id="6ec57-121">A child object is added to the collection.</span></span>  
  
- <span data-ttu-id="6ec57-122">Oggetto <xref:System.Windows.FrameworkElement.LayoutTransform%2A> viene applicato all'oggetto figlio.</span><span class="sxs-lookup"><span data-stu-id="6ec57-122">A <xref:System.Windows.FrameworkElement.LayoutTransform%2A> is applied to the child object.</span></span>  
  
- <span data-ttu-id="6ec57-123">Il <xref:System.Windows.UIElement.UpdateLayout%2A> viene chiamato per l'oggetto figlio.</span><span class="sxs-lookup"><span data-stu-id="6ec57-123">The <xref:System.Windows.UIElement.UpdateLayout%2A> method is called for the child object.</span></span>  
  
- <span data-ttu-id="6ec57-124">Se viene apportata una modifica al valore di una proprietà di dipendenza contrassegnata con metadati che incidono sul passaggio di misurazione o disposizione.</span><span class="sxs-lookup"><span data-stu-id="6ec57-124">When a change occurs to the value of a dependency property that is marked with metadata affecting the measure or arrange passes.</span></span>  
  
### <a name="use-the-most-efficient-panel-where-possible"></a><span data-ttu-id="6ec57-125">Usare il pannello più efficiente, se possibile</span><span class="sxs-lookup"><span data-stu-id="6ec57-125">Use the Most Efficient Panel where Possible</span></span>  
 <span data-ttu-id="6ec57-126">La complessità del processo di layout dipende direttamente dal comportamento di layout di <xref:System.Windows.Controls.Panel>-degli elementi è utilizzare derivati.</span><span class="sxs-lookup"><span data-stu-id="6ec57-126">The complexity of the layout process is directly based on the layout behavior of the <xref:System.Windows.Controls.Panel>-derived elements you use.</span></span> <span data-ttu-id="6ec57-127">Ad esempio, un <xref:System.Windows.Controls.Grid> oppure <xref:System.Windows.Controls.StackPanel> controllo offre molte più funzionalità rispetto a un <xref:System.Windows.Controls.Canvas> controllo.</span><span class="sxs-lookup"><span data-stu-id="6ec57-127">For example, a <xref:System.Windows.Controls.Grid> or <xref:System.Windows.Controls.StackPanel> control provides much more functionality than a <xref:System.Windows.Controls.Canvas> control.</span></span> <span data-ttu-id="6ec57-128">All'aumento delle funzionalità corrisponde, tuttavia, un maggiore dispendio in termini di prestazioni.</span><span class="sxs-lookup"><span data-stu-id="6ec57-128">The price for this greater increase in functionality is a greater increase in performance costs.</span></span> <span data-ttu-id="6ec57-129">Tuttavia, se la funzionalità non è necessario che un <xref:System.Windows.Controls.Grid> fornisce controllo, è necessario usare le alternative meno costose, ad esempio un <xref:System.Windows.Controls.Canvas> o un pannello personalizzato.</span><span class="sxs-lookup"><span data-stu-id="6ec57-129">However, if you do not require the functionality that a <xref:System.Windows.Controls.Grid> control provides, you should use the less costly alternatives, such as a <xref:System.Windows.Controls.Canvas> or a custom panel.</span></span>  
  
 <span data-ttu-id="6ec57-130">Per altre informazioni, vedere [Cenni preliminari sugli elementi Panel](../controls/panels-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6ec57-130">For more information, see [Panels Overview](../controls/panels-overview.md).</span></span>  
  
### <a name="update-rather-than-replace-a-rendertransform"></a><span data-ttu-id="6ec57-131">Aggiornare anziché sostituire una proprietà RenderTransform</span><span class="sxs-lookup"><span data-stu-id="6ec57-131">Update Rather than Replace a RenderTransform</span></span>  
 <span data-ttu-id="6ec57-132">È possibile aggiornare una <xref:System.Windows.Media.Transform> anziché sostituirlo come valore di un <xref:System.Windows.UIElement.RenderTransform%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="6ec57-132">You may be able to update a <xref:System.Windows.Media.Transform> rather than replacing it as the value of a <xref:System.Windows.UIElement.RenderTransform%2A> property.</span></span> <span data-ttu-id="6ec57-133">Questa possibilità può essere attuata soprattutto negli scenari con animazioni.</span><span class="sxs-lookup"><span data-stu-id="6ec57-133">This is particularly true in scenarios that involve animation.</span></span> <span data-ttu-id="6ec57-134">Aggiornando un oggetto esistente <xref:System.Windows.Media.Transform>, si evita di attivare un calcolo dell'oggetto layout non necessari.</span><span class="sxs-lookup"><span data-stu-id="6ec57-134">By updating an existing <xref:System.Windows.Media.Transform>, you avoid initiating an unnecessary layout calculation.</span></span>  
  
### <a name="build-your-tree-top-down"></a><span data-ttu-id="6ec57-135">Compilare la struttura ad albero dall'alto in basso</span><span class="sxs-lookup"><span data-stu-id="6ec57-135">Build Your Tree Top-Down</span></span>  
 <span data-ttu-id="6ec57-136">Quando si aggiunge o si rimuove un nodo dall'albero logico, le convalide di proprietà vengono annullate sull'elemento padre e su tutti gli elementi figlio del nodo.</span><span class="sxs-lookup"><span data-stu-id="6ec57-136">When a node is added or removed from the logical tree, property invalidations are raised on the node's parent and all its children.</span></span> <span data-ttu-id="6ec57-137">Di conseguenza, è sempre consigliabile seguire un pattern di costruzione dall'alto in basso per evitare il costo di annullamenti di convalide non necessari su nodi già convalidati.</span><span class="sxs-lookup"><span data-stu-id="6ec57-137">As a result, a top-down construction pattern should always be followed to avoid the cost of unnecessary invalidations on nodes that have already been validated.</span></span> <span data-ttu-id="6ec57-138">La tabella seguente illustra la differenza in velocità di esecuzione tra la creazione di una struttura ad albero dall'alto in basso rispetto a basso in alto, in cui la struttura ad albero presenta 150 livelli di profondità con un unico <xref:System.Windows.Controls.TextBlock> e <xref:System.Windows.Controls.DockPanel> a ogni livello.</span><span class="sxs-lookup"><span data-stu-id="6ec57-138">The following table shows the difference in execution speed between building a tree top-down versus bottom-up, where the tree is 150 levels deep with a single <xref:System.Windows.Controls.TextBlock> and <xref:System.Windows.Controls.DockPanel> at each level.</span></span>  
  
|<span data-ttu-id="6ec57-139">**Azione**</span><span class="sxs-lookup"><span data-stu-id="6ec57-139">**Action**</span></span>|<span data-ttu-id="6ec57-140">**Compilazione della struttura ad albero (in ms)**</span><span class="sxs-lookup"><span data-stu-id="6ec57-140">**Tree building (in ms)**</span></span>|<span data-ttu-id="6ec57-141">**Rendering: include la compilazione della struttura ad albero (in ms)**</span><span class="sxs-lookup"><span data-stu-id="6ec57-141">**Render—includes tree building (in ms)**</span></span>|  
|----------------|---------------------------------|-------------------------------------------------|  
|<span data-ttu-id="6ec57-142">Dal basso in alto</span><span class="sxs-lookup"><span data-stu-id="6ec57-142">Bottom-up</span></span>|<span data-ttu-id="6ec57-143">366</span><span class="sxs-lookup"><span data-stu-id="6ec57-143">366</span></span>|<span data-ttu-id="6ec57-144">454</span><span class="sxs-lookup"><span data-stu-id="6ec57-144">454</span></span>|  
|<span data-ttu-id="6ec57-145">Dall'alto in basso</span><span class="sxs-lookup"><span data-stu-id="6ec57-145">Top-down</span></span>|<span data-ttu-id="6ec57-146">11</span><span class="sxs-lookup"><span data-stu-id="6ec57-146">11</span></span>|<span data-ttu-id="6ec57-147">96</span><span class="sxs-lookup"><span data-stu-id="6ec57-147">96</span></span>|  
  
 <span data-ttu-id="6ec57-148">L'esempio di codice seguente illustra come creare una struttura ad albero dall'alto in basso.</span><span class="sxs-lookup"><span data-stu-id="6ec57-148">The following code example demonstrates how to create a tree top down.</span></span>  
  
 [!code-csharp[Performance#PerformanceSnippet1](~/samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/Window1.xaml.cs#performancesnippet1)]
 [!code-vb[Performance#PerformanceSnippet1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/Performance/visualbasic/window1.xaml.vb#performancesnippet1)]  
  
 <span data-ttu-id="6ec57-149">Per altre informazioni sull'albero logico, vedere [Strutture ad albero in WPF](trees-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="6ec57-149">For more information on the logical tree, see [Trees in WPF](trees-in-wpf.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6ec57-150">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="6ec57-150">See also</span></span>

- [<span data-ttu-id="6ec57-151">Ottimizzazione delle prestazioni di applicazioni WPF</span><span class="sxs-lookup"><span data-stu-id="6ec57-151">Optimizing WPF Application Performance</span></span>](optimizing-wpf-application-performance.md)
- [<span data-ttu-id="6ec57-152">Pianificazione delle prestazioni dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="6ec57-152">Planning for Application Performance</span></span>](planning-for-application-performance.md)
- [<span data-ttu-id="6ec57-153">Sfruttare appieno l'hardware</span><span class="sxs-lookup"><span data-stu-id="6ec57-153">Taking Advantage of Hardware</span></span>](optimizing-performance-taking-advantage-of-hardware.md)
- [<span data-ttu-id="6ec57-154">Grafica bidimensionale e creazione di immagini</span><span class="sxs-lookup"><span data-stu-id="6ec57-154">2D Graphics and Imaging</span></span>](optimizing-performance-2d-graphics-and-imaging.md)
- [<span data-ttu-id="6ec57-155">Comportamento dell'oggetto</span><span class="sxs-lookup"><span data-stu-id="6ec57-155">Object Behavior</span></span>](optimizing-performance-object-behavior.md)
- [<span data-ttu-id="6ec57-156">Risorse di applicazioni</span><span class="sxs-lookup"><span data-stu-id="6ec57-156">Application Resources</span></span>](optimizing-performance-application-resources.md)
- [<span data-ttu-id="6ec57-157">per</span><span class="sxs-lookup"><span data-stu-id="6ec57-157">Text</span></span>](optimizing-performance-text.md)
- [<span data-ttu-id="6ec57-158">Data binding</span><span class="sxs-lookup"><span data-stu-id="6ec57-158">Data Binding</span></span>](optimizing-performance-data-binding.md)
- [<span data-ttu-id="6ec57-159">Altri suggerimenti relativi alle prestazioni</span><span class="sxs-lookup"><span data-stu-id="6ec57-159">Other Performance Recommendations</span></span>](optimizing-performance-other-recommendations.md)
- [<span data-ttu-id="6ec57-160">Layout</span><span class="sxs-lookup"><span data-stu-id="6ec57-160">Layout</span></span>](layout.md)
