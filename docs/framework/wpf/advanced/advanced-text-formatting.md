---
title: Formattazione del testo avanzata
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- formatting [WPF]
- text [WPF]
- typography [WPF], text formatting
ms.assetid: f0a7986e-f5b2-485c-a27d-f8e922022212
ms.openlocfilehash: 03d0c5096876305f9a181cc28ff2158066e4d56f
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/23/2019
ms.locfileid: "54577397"
---
# <a name="advanced-text-formatting"></a><span data-ttu-id="b890a-102">Formattazione del testo avanzata</span><span class="sxs-lookup"><span data-stu-id="b890a-102">Advanced Text Formatting</span></span>
<span data-ttu-id="b890a-103">Windows Presentation Foundation (WPF) offre un solido set di [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] per includere testo nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b890a-103">The Windows Presentation Foundation (WPF) provides a robust set of [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] for including text in your application.</span></span> <span data-ttu-id="b890a-104">Layout e [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)], ad esempio <xref:System.Windows.Controls.TextBlock>, fornire i più comuni e gli elementi di utilizzo generale per la presentazione del testo.</span><span class="sxs-lookup"><span data-stu-id="b890a-104">Layout and [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)][!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)], such as <xref:System.Windows.Controls.TextBlock>, provide the most common and general use elements for text presentation.</span></span> <span data-ttu-id="b890a-105">Disegno [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)], ad esempio <xref:System.Windows.Media.GlyphRunDrawing> e <xref:System.Windows.Media.FormattedText>, forniscono un mezzo per includere il testo formattato nei disegni.</span><span class="sxs-lookup"><span data-stu-id="b890a-105">Drawing [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)], such as <xref:System.Windows.Media.GlyphRunDrawing> and <xref:System.Windows.Media.FormattedText>, provide a means for including formatted text in drawings.</span></span> <span data-ttu-id="b890a-106">Al massimo livello avanzato, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] fornisce un motore per controllare tutti gli aspetti della presentazione del testo, ad esempio gestione degli archivi di testo, la gestione della formattazione e gestione degli oggetti incorporati di formattazione del testo estensibile.</span><span class="sxs-lookup"><span data-stu-id="b890a-106">At the most advanced level, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] provides an extensible text formatting engine to control every aspect of text presentation, such as text store management, text run formatting management, and embedded object management.</span></span>  
  
 <span data-ttu-id="b890a-107">In questo argomento viene fornita un'introduzione a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] formattazione del testo.</span><span class="sxs-lookup"><span data-stu-id="b890a-107">This topic provides an introduction to [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] text formatting.</span></span> <span data-ttu-id="b890a-108">L'applicazione è incentrata sull'implementazione di client e uso del [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] motore di formattazione del testo.</span><span class="sxs-lookup"><span data-stu-id="b890a-108">It focuses on client implementation and use of the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] text formatting engine.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b890a-109">Tutti gli esempi di codice all'interno di questo documento sono reperibili nel [esempio di formattazione di testo avanzata](https://go.microsoft.com/fwlink/?LinkID=159965).</span><span class="sxs-lookup"><span data-stu-id="b890a-109">All code examples within this document can be found in the [Advanced Text Formatting Sample](https://go.microsoft.com/fwlink/?LinkID=159965).</span></span>  
  

  
<a name="prereq"></a>   
## <a name="prerequisites"></a><span data-ttu-id="b890a-110">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="b890a-110">Prerequisites</span></span>  
 <span data-ttu-id="b890a-111">Questo argomento si presuppone che abbia familiarità con il livello più alto [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] usato per la presentazione del testo.</span><span class="sxs-lookup"><span data-stu-id="b890a-111">This topic assumes that you are familiar with the higher level [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] used for text presentation.</span></span> <span data-ttu-id="b890a-112">La maggior parte degli scenari utente non richiederanno la formattazione del testo avanzata [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] descritti in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="b890a-112">Most user scenarios will not require the advanced text formatting [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] discussed in this topic.</span></span> <span data-ttu-id="b890a-113">Per un'introduzione al testo diverso [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)], vedere [documenti in WPF](../../../../docs/framework/wpf/advanced/documents-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="b890a-113">For an introduction to the different text [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)], see [Documents in WPF](../../../../docs/framework/wpf/advanced/documents-in-wpf.md).</span></span>  
  
<a name="section1"></a>   
## <a name="advanced-text-formatting"></a><span data-ttu-id="b890a-114">Formattazione del testo avanzata</span><span class="sxs-lookup"><span data-stu-id="b890a-114">Advanced Text Formatting</span></span>  
 <span data-ttu-id="b890a-115">Il layout del testo e [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] controlli [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] forniscono le proprietà di formattazione che consentono di includere facilmente il testo formattato nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b890a-115">The text layout and [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] controls in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] provide formatting properties that allow you to easily include formatted text in your application.</span></span> <span data-ttu-id="b890a-116">Questi controlli espongono numerose proprietà per la gestione della presentazione del testo, inclusi il carattere tipografico, le dimensioni e il colore.</span><span class="sxs-lookup"><span data-stu-id="b890a-116">These controls expose a number of properties to handle the presentation of text, which includes its typeface, size, and color.</span></span> <span data-ttu-id="b890a-117">In circostanze normali, questi controlli sono in grado di gestire la maggior parte degli scenari di presentazione del testo nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b890a-117">Under ordinary circumstances, these controls can handle the majority of text presentation in your application.</span></span> <span data-ttu-id="b890a-118">Tuttavia, alcuni scenari avanzati richiedono il controllo dell'archiviazione del testo e della presentazione del testo.</span><span class="sxs-lookup"><span data-stu-id="b890a-118">However, some advanced scenarios require the control of text storage as well as text presentation.</span></span> <span data-ttu-id="b890a-119">Per questi scopi [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] offre un motore di formattazione del testo estensibile.</span><span class="sxs-lookup"><span data-stu-id="b890a-119">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] provides an extensible text formatting engine for this purpose.</span></span>  
  
 <span data-ttu-id="b890a-120">Il funzionalità di formattazione del testo avanzata trovato [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] costituiti da un testo con formattazione motore, un archivio di testo, le sequenze di testo e le proprietà di formattazione.</span><span class="sxs-lookup"><span data-stu-id="b890a-120">The advanced text formatting features found in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] consist of a text formatting engine, a text store, text runs, and formatting properties.</span></span> <span data-ttu-id="b890a-121">Motore di formattazione del testo <xref:System.Windows.Media.TextFormatting.TextFormatter>, Crea righe di testo da utilizzare per la presentazione.</span><span class="sxs-lookup"><span data-stu-id="b890a-121">The text formatting engine, <xref:System.Windows.Media.TextFormatting.TextFormatter>, creates lines of text to be used for presentation.</span></span> <span data-ttu-id="b890a-122">A questo scopo, avviare il processo di formattazione riga e la chiamata del formattatore di testo <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A>.</span><span class="sxs-lookup"><span data-stu-id="b890a-122">This is achieved by initiating the line formatting process and calling the text formatter's <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A>.</span></span> <span data-ttu-id="b890a-123">Formattatore di testo recupera le sequenze di testo dall'archivio di testo chiamando l'archivio <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="b890a-123">The text formatter retrieves text runs from your text store by calling the store's <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> method.</span></span> <span data-ttu-id="b890a-124">Il <xref:System.Windows.Media.TextFormatting.TextRun> gli oggetti vengono quindi trasformati in <xref:System.Windows.Media.TextFormatting.TextLine> oggetti dal formattatore di testo e passati all'applicazione per l'ispezione o la visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="b890a-124">The <xref:System.Windows.Media.TextFormatting.TextRun> objects are then formed into <xref:System.Windows.Media.TextFormatting.TextLine> objects by the text formatter and given to your application for inspection or display.</span></span>  
  
<a name="section2"></a>   
## <a name="using-the-text-formatter"></a><span data-ttu-id="b890a-125">Uso del formattatore di testo</span><span class="sxs-lookup"><span data-stu-id="b890a-125">Using the Text Formatter</span></span>  
 <span data-ttu-id="b890a-126"><xref:System.Windows.Media.TextFormatting.TextFormatter> è il [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] formattazione del testo del motore e fornisce servizi per la formattazione e l'interruzione delle righe di testo.</span><span class="sxs-lookup"><span data-stu-id="b890a-126"><xref:System.Windows.Media.TextFormatting.TextFormatter> is the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] text formatting engine and provides services for formatting and breaking text lines.</span></span> <span data-ttu-id="b890a-127">Il formattatore di testo può gestire diversi formati di carattere del testo e stili di paragrafo e include il supporto per il layout di testo internazionale.</span><span class="sxs-lookup"><span data-stu-id="b890a-127">The text formatter can handle different text character formats and paragraph styles, and includes support for international text layout.</span></span>  
  
 <span data-ttu-id="b890a-128">A differenza di un testo tradizionali [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)], il <xref:System.Windows.Media.TextFormatting.TextFormatter> interagisce con un client di layout di testo tramite un set di metodi di callback.</span><span class="sxs-lookup"><span data-stu-id="b890a-128">Unlike a traditional text [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)], the <xref:System.Windows.Media.TextFormatting.TextFormatter> interacts with a text layout client through a set of callback methods.</span></span> <span data-ttu-id="b890a-129">È necessario che il client fornisca questi metodi in un'implementazione del <xref:System.Windows.Media.TextFormatting.TextSource> classe.</span><span class="sxs-lookup"><span data-stu-id="b890a-129">It requires the client to provide these methods in an implementation of the <xref:System.Windows.Media.TextFormatting.TextSource> class.</span></span> <span data-ttu-id="b890a-130">Il diagramma seguente illustra l'interazione di layout di testo tra l'applicazione client e <xref:System.Windows.Media.TextFormatting.TextFormatter>.</span><span class="sxs-lookup"><span data-stu-id="b890a-130">The following diagram illustrates the text layout interaction between the client application and <xref:System.Windows.Media.TextFormatting.TextFormatter>.</span></span>  
  
 <span data-ttu-id="b890a-131">![Diagramma del client di layout di testo e TextFormatter](../../../../docs/framework/wpf/advanced/media/textformatter01.png "TextFormatter01")</span><span class="sxs-lookup"><span data-stu-id="b890a-131">![Diagram of text layout client and TextFormatter](../../../../docs/framework/wpf/advanced/media/textformatter01.png "TextFormatter01")</span></span>  
<span data-ttu-id="b890a-132">Interazione tra l'applicazione e TextFormatter</span><span class="sxs-lookup"><span data-stu-id="b890a-132">Interaction between application and TextFormatter</span></span>  
  
 <span data-ttu-id="b890a-133">Il formattatore di testo viene usato per recuperare le righe di testo formattato dall'archivio di testo, che è un'implementazione di <xref:System.Windows.Media.TextFormatting.TextSource>.</span><span class="sxs-lookup"><span data-stu-id="b890a-133">The text formatter is used to retrieve formatted text lines from the text store, which is an implementation of <xref:System.Windows.Media.TextFormatting.TextSource>.</span></span> <span data-ttu-id="b890a-134">Questa operazione viene eseguita creando innanzitutto un'istanza del formattatore di testo utilizzando il <xref:System.Windows.Media.TextFormatting.TextFormatter.Create%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="b890a-134">This is done by first creating an instance of the text formatter by using the <xref:System.Windows.Media.TextFormatting.TextFormatter.Create%2A> method.</span></span> <span data-ttu-id="b890a-135">Questo metodo crea un'istanza del formattatore di testo e imposta i valori massimi di altezza e larghezza della riga.</span><span class="sxs-lookup"><span data-stu-id="b890a-135">This method creates an instance of the text formatter and sets the maximum line height and width values.</span></span> <span data-ttu-id="b890a-136">Non appena viene creata un'istanza del formattatore di testo, viene avviato il processo di creazione riga chiamando la <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="b890a-136">As soon as an instance of the text formatter is created, the line creation process is started by calling the <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A> method.</span></span> <span data-ttu-id="b890a-137"><xref:System.Windows.Media.TextFormatting.TextFormatter> richiama l'origine del testo per recuperare il testo e i parametri di formattazione per le sequenze di testo che formano una riga.</span><span class="sxs-lookup"><span data-stu-id="b890a-137"><xref:System.Windows.Media.TextFormatting.TextFormatter> calls back to the text source to retrieve the text and formatting parameters for the runs of text that form a line.</span></span>  
  
 <span data-ttu-id="b890a-138">L'esempio seguente illustra il processo di formattazione di un archivio di testo.</span><span class="sxs-lookup"><span data-stu-id="b890a-138">In the following example, the process of formatting a text store is shown.</span></span> <span data-ttu-id="b890a-139">Il <xref:System.Windows.Media.TextFormatting.TextFormatter> oggetto viene usato per recuperare le righe di testo dall'archivio di testo e quindi formattare la riga di testo per il disegno nel <xref:System.Windows.Media.DrawingContext>.</span><span class="sxs-lookup"><span data-stu-id="b890a-139">The <xref:System.Windows.Media.TextFormatting.TextFormatter> object is used to retrieve text lines from the text store and then format the text line for drawing into the <xref:System.Windows.Media.DrawingContext>.</span></span>  
  
 [!code-csharp[TextFormatterExample#100](../../../../samples/snippets/csharp/VS_Snippets_Wpf/TextFormatterExample/CSharp/Window1.xaml.cs#100)]
 [!code-vb[TextFormatterExample#100](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/TextFormatterExample/VisualBasic/Window1.xaml.vb#100)]  
  
<a name="section3"></a>   
## <a name="implementing-the-client-text-store"></a><span data-ttu-id="b890a-140">Implementazione dell'archivio di testo del client</span><span class="sxs-lookup"><span data-stu-id="b890a-140">Implementing the Client Text Store</span></span>  
 <span data-ttu-id="b890a-141">Quando si estende il motore di formattazione del testo, è necessario implementare e gestire tutti gli aspetti dell'archivio di testo.</span><span class="sxs-lookup"><span data-stu-id="b890a-141">When you extend the text formatting engine, you are required to implement and manage all aspects of the text store.</span></span> <span data-ttu-id="b890a-142">Non si tratta di un'attività elementare.</span><span class="sxs-lookup"><span data-stu-id="b890a-142">This is not a trivial task.</span></span> <span data-ttu-id="b890a-143">L'archivio di testo è responsabile del rilevamento delle proprietà delle sequenze di testo, delle proprietà dei paragrafi, degli oggetti incorporati e di altri contenuti simili.</span><span class="sxs-lookup"><span data-stu-id="b890a-143">The text store is responsible for tracking text run properties, paragraph properties, embedded objects, and other similar content.</span></span> <span data-ttu-id="b890a-144">Fornisce inoltre il formattatore di testo con singole <xref:System.Windows.Media.TextFormatting.TextRun> oggetti che utilizza il formattatore di testo per creare <xref:System.Windows.Media.TextFormatting.TextLine> oggetti.</span><span class="sxs-lookup"><span data-stu-id="b890a-144">It also provides the text formatter with individual <xref:System.Windows.Media.TextFormatting.TextRun> objects which the text formatter uses to create <xref:System.Windows.Media.TextFormatting.TextLine> objects.</span></span>  
  
 <span data-ttu-id="b890a-145">Per gestire la virtualizzazione dell'archivio di testo, l'archivio di testo deve essere derivato da <xref:System.Windows.Media.TextFormatting.TextSource>.</span><span class="sxs-lookup"><span data-stu-id="b890a-145">To handle the virtualization of the text store, the text store must be derived from <xref:System.Windows.Media.TextFormatting.TextSource>.</span></span> <span data-ttu-id="b890a-146"><xref:System.Windows.Media.TextFormatting.TextSource> definisce il metodo che viene utilizzato il formattatore di testo per recuperare le sequenze di testo dall'archivio di testo.</span><span class="sxs-lookup"><span data-stu-id="b890a-146"><xref:System.Windows.Media.TextFormatting.TextSource> defines the method the text formatter uses to retrieve text runs from the text store.</span></span> <span data-ttu-id="b890a-147"><xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> è il metodo usato dal formattatore di testo per recuperare il testo viene eseguito usato nella formattazione delle righe.</span><span class="sxs-lookup"><span data-stu-id="b890a-147"><xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> is the method used by the text formatter to retrieve text runs used in line formatting.</span></span> <span data-ttu-id="b890a-148">La chiamata a <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> viene effettuata ripetutamente dal formattatore di testo fino a quando non si verifica una delle condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="b890a-148">The call to <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> is repeatedly made by the text formatter until one of the following conditions occurs:</span></span>  
  
-   <span data-ttu-id="b890a-149">Oggetto <xref:System.Windows.Media.TextFormatting.TextEndOfLine> o viene restituita una sottoclasse.</span><span class="sxs-lookup"><span data-stu-id="b890a-149">A <xref:System.Windows.Media.TextFormatting.TextEndOfLine> or a subclass is returned.</span></span>  
  
-   <span data-ttu-id="b890a-150">La larghezza complessiva delle sequenze di testo supera la larghezza massima della riga specificata nella chiamata per creare il formattatore di testo o la chiamata per il formattatore di testo <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="b890a-150">The accumulated width of text runs exceeds the maximum line width specified in either the call to create the text formatter or the call to the text formatter's <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A> method.</span></span>  
  
-   <span data-ttu-id="b890a-151">Oggetto [!INCLUDE[TLA#tla_unicode](../../../../includes/tlasharptla-unicode-md.md)] sequenza di nuova riga, ad esempio "CF", "LF" o "CRLF", viene restituito.</span><span class="sxs-lookup"><span data-stu-id="b890a-151">A [!INCLUDE[TLA#tla_unicode](../../../../includes/tlasharptla-unicode-md.md)] newline sequence, such as "CF", "LF", or "CRLF", is returned.</span></span>  
  
<a name="section4"></a>   
## <a name="providing-text-runs"></a><span data-ttu-id="b890a-152">Inserimento delle sequenze di testo</span><span class="sxs-lookup"><span data-stu-id="b890a-152">Providing Text Runs</span></span>  
 <span data-ttu-id="b890a-153">Il fulcro del processo di formattazione del testo è rappresentato dall'interazione tra il formattatore di testo e l'archivio di testo.</span><span class="sxs-lookup"><span data-stu-id="b890a-153">The core of the text formatting process is the interaction between the text formatter and the text store.</span></span> <span data-ttu-id="b890a-154">L'implementazione di <xref:System.Windows.Media.TextFormatting.TextSource> fornisce al formattatore di testo con il <xref:System.Windows.Media.TextFormatting.TextRun> oggetti e le proprietà con cui si vuole formattare il testo viene eseguito.</span><span class="sxs-lookup"><span data-stu-id="b890a-154">Your implementation of <xref:System.Windows.Media.TextFormatting.TextSource> provides the text formatter with the <xref:System.Windows.Media.TextFormatting.TextRun> objects and the properties with which to format the text runs.</span></span> <span data-ttu-id="b890a-155">Questa interazione viene gestita dal <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> metodo, che viene chiamato dal formattatore di testo.</span><span class="sxs-lookup"><span data-stu-id="b890a-155">This interaction is handled by the <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> method, which is called by the text formatter.</span></span>  
  
 <span data-ttu-id="b890a-156">Nella tabella seguente vengono illustrati alcuni degli operatori <xref:System.Windows.Media.TextFormatting.TextRun> oggetti.</span><span class="sxs-lookup"><span data-stu-id="b890a-156">The following table shows some of the predefined <xref:System.Windows.Media.TextFormatting.TextRun> objects.</span></span>  
  
|<span data-ttu-id="b890a-157">Tipo di TextRun</span><span class="sxs-lookup"><span data-stu-id="b890a-157">TextRun Type</span></span>|<span data-ttu-id="b890a-158">Utilizzo</span><span class="sxs-lookup"><span data-stu-id="b890a-158">Usage</span></span>|  
|------------------|-----------|  
|<xref:System.Windows.Media.TextFormatting.TextCharacters>|<span data-ttu-id="b890a-159">Sequenza di testo specializzata usata per passare nuovamente al formattatore di testo una rappresentazione dei glifi dei caratteri.</span><span class="sxs-lookup"><span data-stu-id="b890a-159">The specialized text run used to pass a representation of character glyphs back to the text formatter.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEmbeddedObject>|<span data-ttu-id="b890a-160">Sequenza di testo specializzata usata per fornire contenuto nel quale la misurazione, l'hit testing e il disegno vengono eseguite come un'unica operazione, ad esempio un pulsante o un'immagine all'interno del testo.</span><span class="sxs-lookup"><span data-stu-id="b890a-160">The specialized text run used to provide content in which measuring, hit testing, and drawing is done in whole, such as a button or image within the text.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEndOfLine>|<span data-ttu-id="b890a-161">Sequenza di testo specializzata usata per contrassegnare la fine di una riga.</span><span class="sxs-lookup"><span data-stu-id="b890a-161">The specialized text run used to mark the end of a line.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEndOfParagraph>|<span data-ttu-id="b890a-162">Sequenza di testo specializzata usata per contrassegnare la fine di un paragrafo.</span><span class="sxs-lookup"><span data-stu-id="b890a-162">The specialized text run used to mark the end of a paragraph.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEndOfSegment>|<span data-ttu-id="b890a-163">Sequenza di testo specializzato usata per contrassegnare la fine di un segmento, ad esempio per terminare l'ambito interessato da una precedente <xref:System.Windows.Media.TextFormatting.TextModifier> eseguire.</span><span class="sxs-lookup"><span data-stu-id="b890a-163">The specialized text run used to mark the end of a segment, such as to end the scope affected by a previous <xref:System.Windows.Media.TextFormatting.TextModifier> run.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextHidden>|<span data-ttu-id="b890a-164">Sequenza di testo specializzata usata per contrassegnare un intervallo di caratteri nascosti.</span><span class="sxs-lookup"><span data-stu-id="b890a-164">The specialized text run used to mark a range of hidden characters.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextModifier>|<span data-ttu-id="b890a-165">Sequenza di testo specializzata usata per modificare le proprietà delle sequenze di testo nel relativo ambito.</span><span class="sxs-lookup"><span data-stu-id="b890a-165">The specialized text run used to modify properties of text runs in its scope.</span></span> <span data-ttu-id="b890a-166">L'ambito si estende il successivo corrispondente <xref:System.Windows.Media.TextFormatting.TextEndOfSegment> della sequenza di testo o al successivo <xref:System.Windows.Media.TextFormatting.TextEndOfParagraph>.</span><span class="sxs-lookup"><span data-stu-id="b890a-166">The scope extends to the next matching <xref:System.Windows.Media.TextFormatting.TextEndOfSegment> text run, or the next <xref:System.Windows.Media.TextFormatting.TextEndOfParagraph>.</span></span>|  
  
 <span data-ttu-id="b890a-167">Predefiniti <xref:System.Windows.Media.TextFormatting.TextRun> può essere sottoclassato.</span><span class="sxs-lookup"><span data-stu-id="b890a-167">Any of the predefined <xref:System.Windows.Media.TextFormatting.TextRun> objects can be subclassed.</span></span> <span data-ttu-id="b890a-168">Ciò consente all'origine del testo di fornire al formattatore di testo sequenze di testo che includono dati personalizzati.</span><span class="sxs-lookup"><span data-stu-id="b890a-168">This allows your text source to provide the text formatter with text runs that include custom data.</span></span>  
  
 <span data-ttu-id="b890a-169">L'esempio seguente illustra un <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="b890a-169">The following example demonstrates a <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> method.</span></span> <span data-ttu-id="b890a-170">Questo archivio di testo restituisce <xref:System.Windows.Media.TextFormatting.TextRun> oggetti al formattatore di testo per l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="b890a-170">This text store returns <xref:System.Windows.Media.TextFormatting.TextRun> objects to the text formatter for processing.</span></span>  
  
 [!code-csharp[TextFormatterExample#101](../../../../samples/snippets/csharp/VS_Snippets_Wpf/TextFormatterExample/CSharp/CustomTextSource.cs#101)]
 [!code-vb[TextFormatterExample#101](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/TextFormatterExample/VisualBasic/CustomTextSource.vb#101)]  
  
> [!NOTE]
>  <span data-ttu-id="b890a-171">In questo esempio, l'archivio di testo fornisce a tutto il testo le stesse proprietà.</span><span class="sxs-lookup"><span data-stu-id="b890a-171">In this example, the text store provides the same text properties to all of the text.</span></span> <span data-ttu-id="b890a-172">Gli archivi di testo avanzati devono implementare una gestione personalizzata dell'estensione in modo da consentire ai singoli caratteri di avere proprietà diverse.</span><span class="sxs-lookup"><span data-stu-id="b890a-172">Advanced text stores would need to implement their own span management to allow individual characters to have different properties.</span></span>  
  
<a name="section5"></a>   
## <a name="specifying-formatting-properties"></a><span data-ttu-id="b890a-173">Specifica delle proprietà di formattazione</span><span class="sxs-lookup"><span data-stu-id="b890a-173">Specifying Formatting Properties</span></span>  
 <span data-ttu-id="b890a-174"><xref:System.Windows.Media.TextFormatting.TextRun> gli oggetti vengono formattati usando le proprietà fornite dall'archivio di testo.</span><span class="sxs-lookup"><span data-stu-id="b890a-174"><xref:System.Windows.Media.TextFormatting.TextRun> objects are formatted by using properties provided by the text store.</span></span> <span data-ttu-id="b890a-175">Queste proprietà possono essere di due tipi <xref:System.Windows.Media.TextFormatting.TextParagraphProperties> e <xref:System.Windows.Media.TextFormatting.TextRunProperties>.</span><span class="sxs-lookup"><span data-stu-id="b890a-175">These properties come in two types, <xref:System.Windows.Media.TextFormatting.TextParagraphProperties> and <xref:System.Windows.Media.TextFormatting.TextRunProperties>.</span></span> <span data-ttu-id="b890a-176"><xref:System.Windows.Media.TextFormatting.TextParagraphProperties> gestire, ad esempio le proprietà che interessano paragrafo <xref:System.Windows.TextAlignment> e <xref:System.Windows.FlowDirection>.</span><span class="sxs-lookup"><span data-stu-id="b890a-176"><xref:System.Windows.Media.TextFormatting.TextParagraphProperties> handle paragraph inclusive properties such as <xref:System.Windows.TextAlignment> and <xref:System.Windows.FlowDirection>.</span></span> <span data-ttu-id="b890a-177"><xref:System.Windows.Media.TextFormatting.TextRunProperties> proprietà che possono essere diversi ogni sequenza di testo all'interno di un paragrafo, ad esempio il pennello in primo piano, <xref:System.Windows.Media.Typeface>e la dimensione del carattere.</span><span class="sxs-lookup"><span data-stu-id="b890a-177"><xref:System.Windows.Media.TextFormatting.TextRunProperties> are properties that can be different for each text run within a paragraph, such as foreground brush, <xref:System.Windows.Media.Typeface>, and font size.</span></span> <span data-ttu-id="b890a-178">Per implementare paragrafo personalizzato e i tipi di proprietà di testo personalizzato, l'applicazione deve creare classi che derivano da <xref:System.Windows.Media.TextFormatting.TextParagraphProperties> e <xref:System.Windows.Media.TextFormatting.TextRunProperties> rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="b890a-178">To implement custom paragraph and custom text run property types, your application must create classes that derive from <xref:System.Windows.Media.TextFormatting.TextParagraphProperties> and <xref:System.Windows.Media.TextFormatting.TextRunProperties> respectively.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b890a-179">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="b890a-179">See also</span></span>
- [<span data-ttu-id="b890a-180">Funzionalità tipografiche di WPF</span><span class="sxs-lookup"><span data-stu-id="b890a-180">Typography in WPF</span></span>](../../../../docs/framework/wpf/advanced/typography-in-wpf.md)
- [<span data-ttu-id="b890a-181">Documenti in WPF</span><span class="sxs-lookup"><span data-stu-id="b890a-181">Documents in WPF</span></span>](../../../../docs/framework/wpf/advanced/documents-in-wpf.md)
