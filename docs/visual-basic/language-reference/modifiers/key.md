---
title: Key (Visual Basic)
ms.date: 07/20/2015
f1_keywords:
- vb.AnonymousKey
helpviewer_keywords:
- anonymous types [Visual Basic], key
- Key [Visual Basic]
- Key keyword [Visual Basic]
ms.assetid: 7697a928-7d14-4430-a72a-c9e96e8d6c11
ms.openlocfilehash: 695f356f44bfd6ea5ad3c0a977ec31ddfbea2b05
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/23/2019
ms.locfileid: "54668223"
---
# <a name="key-visual-basic"></a><span data-ttu-id="e0870-102">Key (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="e0870-102">Key (Visual Basic)</span></span>
<span data-ttu-id="e0870-103">Il `Key` (parola chiave) consente di specificare il comportamento per le proprietà di tipi anonimi.</span><span class="sxs-lookup"><span data-stu-id="e0870-103">The `Key` keyword enables you to specify behavior for properties of anonymous types.</span></span> <span data-ttu-id="e0870-104">Solo le proprietà designate come proprietà chiave fanno parte di test di uguaglianza tra le istanze di tipo anonimo o un calcolo dei valori di codice hash.</span><span class="sxs-lookup"><span data-stu-id="e0870-104">Only properties you designate as key properties participate in tests of equality between anonymous type instances, or calculation of hash code values.</span></span> <span data-ttu-id="e0870-105">I valori delle proprietà chiave non possono essere modificati.</span><span class="sxs-lookup"><span data-stu-id="e0870-105">The values of key properties cannot be changed.</span></span>  
  
 <span data-ttu-id="e0870-106">Si definisce una proprietà di un tipo anonimo come proprietà chiave inserendo la parola chiave `Key` davanti relativa dichiarazione nell'elenco di inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="e0870-106">You designate a property of an anonymous type as a key property by placing the keyword `Key` in front of its declaration in the initialization list.</span></span> <span data-ttu-id="e0870-107">Nell'esempio riportato di seguito `Airline` e `FlightNo` sono le proprietà di chiave, ma `Gate` non.</span><span class="sxs-lookup"><span data-stu-id="e0870-107">In the following example, `Airline` and `FlightNo` are key properties, but `Gate` is not.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#26](../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/key_1.vb)]  
  
 <span data-ttu-id="e0870-108">Quando viene creato un nuovo tipo anonimo, eredita direttamente da <xref:System.Object>.</span><span class="sxs-lookup"><span data-stu-id="e0870-108">When a new anonymous type is created, it inherits directly from <xref:System.Object>.</span></span> <span data-ttu-id="e0870-109">Il compilatore esegue l'override di tre membri ereditati: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, e <xref:System.Object.ToString%2A>.</span><span class="sxs-lookup"><span data-stu-id="e0870-109">The compiler overrides three inherited members: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, and <xref:System.Object.ToString%2A>.</span></span> <span data-ttu-id="e0870-110">Il codice di prodotto per gli override <xref:System.Object.Equals%2A> e <xref:System.Object.GetHashCode%2A> è basato sulle proprietà chiave.</span><span class="sxs-lookup"><span data-stu-id="e0870-110">The override code that is produced for <xref:System.Object.Equals%2A> and <xref:System.Object.GetHashCode%2A> is based on key properties.</span></span> <span data-ttu-id="e0870-111">Se non esistono proprietà chiave del tipo, <xref:System.Object.GetHashCode%2A> e <xref:System.Object.Equals%2A> non sottoposto a override.</span><span class="sxs-lookup"><span data-stu-id="e0870-111">If there are no key properties in the type, <xref:System.Object.GetHashCode%2A> and <xref:System.Object.Equals%2A> are not overridden.</span></span>  
  
## <a name="equality"></a><span data-ttu-id="e0870-112">Uguaglianza</span><span class="sxs-lookup"><span data-stu-id="e0870-112">Equality</span></span>  
 <span data-ttu-id="e0870-113">Due istanze di tipo anonimo sono uguali se sono istanze dello stesso tipo e se i valori delle relative proprietà chiave sono uguali.</span><span class="sxs-lookup"><span data-stu-id="e0870-113">Two anonymous type instances are equal if they are instances of the same type and if the values of their key properties are equal.</span></span> <span data-ttu-id="e0870-114">Negli esempi seguenti `flight2` è uguale a `flight1` dall'esempio precedente perché sono istanze dello stesso anonimo tipo e disporre di valori corrispondenti per le relative proprietà chiave.</span><span class="sxs-lookup"><span data-stu-id="e0870-114">In the following examples, `flight2` is equal to `flight1` from the previous example because they are instances of the same anonymous type and they have matching values for their key properties.</span></span> <span data-ttu-id="e0870-115">Tuttavia `flight3` non è uguale a `flight1` perché contiene un valore diverso per una proprietà chiave, `FlightNo`.</span><span class="sxs-lookup"><span data-stu-id="e0870-115">However, `flight3` is not equal to `flight1` because it has a different value for a key property, `FlightNo`.</span></span> <span data-ttu-id="e0870-116">Istanza `flight4` non è dello stesso tipo `flight1` poiché definiscono le diverse proprietà come proprietà chiave.</span><span class="sxs-lookup"><span data-stu-id="e0870-116">Instance `flight4` is not the same type as `flight1` because they designate different properties as key properties.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#27](../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/key_2.vb)]  
  
 <span data-ttu-id="e0870-117">Se due istanze vengono dichiarate con solo proprietà non chiave, identica nel nome, tipo, ordine e valore, le due istanze non sono uguali.</span><span class="sxs-lookup"><span data-stu-id="e0870-117">If two instances are declared with only non-key properties, identical in name, type, order, and value, the two instances are not equal.</span></span> <span data-ttu-id="e0870-118">Un'istanza senza proprietà chiave è uguale solo a se stesso.</span><span class="sxs-lookup"><span data-stu-id="e0870-118">An instance without key properties is equal only to itself.</span></span>  
  
 <span data-ttu-id="e0870-119">Per altre informazioni sulle condizioni in cui due istanze di tipo anonimo sono istanze dello stesso tipo anonimo, vedere [i tipi anonimi](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md).</span><span class="sxs-lookup"><span data-stu-id="e0870-119">For more information about the conditions under which two anonymous type instances are instances of the same anonymous type, see [Anonymous Types](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md).</span></span>  
  
## <a name="hash-code-calculation"></a><span data-ttu-id="e0870-120">Calcolo del codice hash</span><span class="sxs-lookup"><span data-stu-id="e0870-120">Hash Code Calculation</span></span>  
 <span data-ttu-id="e0870-121">Ad esempio <xref:System.Object.Equals%2A>, la funzione hash che viene definita in <xref:System.Object.GetHashCode%2A> per un tipo anonimo si basa sulle proprietà del tipo di chiave.</span><span class="sxs-lookup"><span data-stu-id="e0870-121">Like <xref:System.Object.Equals%2A>, the hash function that is defined in <xref:System.Object.GetHashCode%2A> for an anonymous type is based on the key properties of the type.</span></span> <span data-ttu-id="e0870-122">Gli esempi seguenti mostrano l'interazione tra le proprietà di chiave e hash di valori di codice.</span><span class="sxs-lookup"><span data-stu-id="e0870-122">The following examples show the interaction between key properties and hash code values.</span></span>  
  
 <span data-ttu-id="e0870-123">Le istanze di un tipo anonimo che hanno gli stessi valori per tutte le proprietà chiave hanno lo stesso valore di codice hash, anche se le proprietà non chiave sono privi di valori corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="e0870-123">Instances of an anonymous type that have the same values for all key properties have the same hash code value, even if non-key properties do not have matching values.</span></span> <span data-ttu-id="e0870-124">L'istruzione seguente restituisce `True`.</span><span class="sxs-lookup"><span data-stu-id="e0870-124">The following statement returns `True`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#37](../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/key_3.vb)]  
  
 <span data-ttu-id="e0870-125">Le istanze di un tipo anonimo che hanno valori diversi per uno o più proprietà di chiave con valori di codice hash diversa.</span><span class="sxs-lookup"><span data-stu-id="e0870-125">Instances of an anonymous type that have different values for one or more key properties have different hash code values.</span></span> <span data-ttu-id="e0870-126">L'istruzione seguente restituisce `False`.</span><span class="sxs-lookup"><span data-stu-id="e0870-126">The following statement returns `False`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#38](../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/key_4.vb)]  
  
 <span data-ttu-id="e0870-127">Le istanze di tipi anonimi che definiscono le diverse proprietà come proprietà chiave non sono istanze dello stesso tipo.</span><span class="sxs-lookup"><span data-stu-id="e0870-127">Instances of anonymous types that designate different properties as key properties are not instances of the same type.</span></span> <span data-ttu-id="e0870-128">Hanno valori di codice hash diverso anche quando i nomi e valori di tutte le proprietà sono uguali.</span><span class="sxs-lookup"><span data-stu-id="e0870-128">They have different hash code values even when the names and values of all properties are the same.</span></span> <span data-ttu-id="e0870-129">L'istruzione seguente restituisce `False`.</span><span class="sxs-lookup"><span data-stu-id="e0870-129">The following statement returns `False`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#39](../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/key_5.vb)]  
  
## <a name="read-only-values"></a><span data-ttu-id="e0870-130">Valori di sola lettura</span><span class="sxs-lookup"><span data-stu-id="e0870-130">Read-Only Values</span></span>  
 <span data-ttu-id="e0870-131">I valori delle proprietà chiave non possono essere modificati.</span><span class="sxs-lookup"><span data-stu-id="e0870-131">The values of key properties cannot be changed.</span></span> <span data-ttu-id="e0870-132">Ad esempio, nella `flight1` negli esempi precedenti, il `Airline` e `FlightNo` campi sono di sola lettura, ma `Gate` può essere modificato.</span><span class="sxs-lookup"><span data-stu-id="e0870-132">For example, in `flight1` in the earlier examples, the `Airline` and `FlightNo` fields are read-only, but `Gate` can be changed.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#28](../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/key_6.vb)]  
  
## <a name="see-also"></a><span data-ttu-id="e0870-133">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="e0870-133">See also</span></span>
- [<span data-ttu-id="e0870-134">Definizione di tipo anonimo</span><span class="sxs-lookup"><span data-stu-id="e0870-134">Anonymous Type Definition</span></span>](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md)
- [<span data-ttu-id="e0870-135">Procedura: Dedurre i nomi delle proprietà e i tipi nelle dichiarazioni di tipo anonimo</span><span class="sxs-lookup"><span data-stu-id="e0870-135">How to: Infer Property Names and Types in Anonymous Type Declarations</span></span>](../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)
- [<span data-ttu-id="e0870-136">Tipi anonimi</span><span class="sxs-lookup"><span data-stu-id="e0870-136">Anonymous Types</span></span>](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)
