---
title: Tipi anonimi (Visual Basic)
ms.date: 07/20/2015
f1_keywords:
- vb.AnonymousType
helpviewer_keywords:
- anonymous types [Visual Basic], about anonymous types
- anonymous types [Visual Basic]
- types [Visual Basic], anonymous
ms.assetid: 7b87532c-4b3e-4398-8503-6ea9d67574a4
ms.openlocfilehash: 824481c9c73d496998d5810c620b2317c1ec252a
ms.sourcegitcommit: 41c0637e894fbcd0713d46d6ef1866f08dc321a2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/01/2019
ms.locfileid: "57203441"
---
# <a name="anonymous-types-visual-basic"></a><span data-ttu-id="726b4-102">Tipi anonimi (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="726b4-102">Anonymous Types (Visual Basic)</span></span>
<span data-ttu-id="726b4-103">Visual Basic supporta i tipi anonimi, che consentono di creare oggetti senza scrivere una definizione di classe per il tipo di dati.</span><span class="sxs-lookup"><span data-stu-id="726b4-103">Visual Basic supports anonymous types, which enable you to create objects without writing a class definition for the data type.</span></span> <span data-ttu-id="726b4-104">La classe viene generata direttamente dal compilatore.</span><span class="sxs-lookup"><span data-stu-id="726b4-104">Instead, the compiler generates a class for you.</span></span> <span data-ttu-id="726b4-105">La classe non ha alcun nome utilizzabile, eredita direttamente da <xref:System.Object>e contiene le proprietà specificate nella dichiarazione dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="726b4-105">The class has no usable name, inherits directly from <xref:System.Object>, and contains the properties you specify in declaring the object.</span></span> <span data-ttu-id="726b4-106">Poiché il nome del tipo di dati non è specificato, viene considerato un *tipo anonimo*.</span><span class="sxs-lookup"><span data-stu-id="726b4-106">Because the name of the data type is not specified, it is referred to as an *anonymous type*.</span></span>  
  
 <span data-ttu-id="726b4-107">Nell'esempio seguente viene dichiarata e crea variabile `product` come un'istanza di un tipo anonimo che ha due proprietà, `Name` e `Price`.</span><span class="sxs-lookup"><span data-stu-id="726b4-107">The following example declares and creates variable `product` as an instance of an anonymous type that has two properties, `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#1)]  
  
 <span data-ttu-id="726b4-108">Oggetto *espressione di query* Usa i tipi anonimi per combinare le colonne di dati selezionate da una query.</span><span class="sxs-lookup"><span data-stu-id="726b4-108">A *query expression* uses anonymous types to combine columns of data selected by a query.</span></span> <span data-ttu-id="726b4-109">È possibile definire il tipo del risultato in anticipo, poiché non è possibile prevedere le colonne che potrebbe selezionare una determinata query.</span><span class="sxs-lookup"><span data-stu-id="726b4-109">You cannot define the type of the result in advance, because you cannot predict the columns a particular query might select.</span></span> <span data-ttu-id="726b4-110">I tipi anonimi consentono di scrivere una query che seleziona un numero qualsiasi di colonne, in qualsiasi ordine.</span><span class="sxs-lookup"><span data-stu-id="726b4-110">Anonymous types enable you to write a query that selects any number of columns, in any order.</span></span> <span data-ttu-id="726b4-111">Il compilatore crea un tipo di dati che corrisponde alla proprietà specificate e l'ordine specificato.</span><span class="sxs-lookup"><span data-stu-id="726b4-111">The compiler creates a data type that matches the specified properties and the specified order.</span></span>  
  
 <span data-ttu-id="726b4-112">Negli esempi seguenti, `products` è un elenco di oggetti product, ognuno dei quali ha diverse proprietà.</span><span class="sxs-lookup"><span data-stu-id="726b4-112">In the following examples, `products` is a list of product objects, each of which has many properties.</span></span> <span data-ttu-id="726b4-113">Variabile `namePriceQuery` contiene la definizione di una query che, quando eseguita, restituisce una raccolta di istanze di un tipo anonimo con due proprietà, `Name` e `Price`.</span><span class="sxs-lookup"><span data-stu-id="726b4-113">Variable `namePriceQuery` holds the definition of a query that, when it is executed, returns a collection of instances of an anonymous type that has two properties, `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#2)]  
  
 <span data-ttu-id="726b4-114">Variabile `nameQuantityQuery` contiene la definizione di una query che, quando eseguita, restituisce una raccolta di istanze di un tipo anonimo con due proprietà, `Name` e `OnHand`.</span><span class="sxs-lookup"><span data-stu-id="726b4-114">Variable `nameQuantityQuery` holds the definition of a query that, when it is executed, returns a collection of instances of an anonymous type that has two properties, `Name` and `OnHand`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#3)]  
  
 <span data-ttu-id="726b4-115">Per altre informazioni sul codice creato dal compilatore per un tipo anonimo, vedere [definizione di tipo anonimo](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md).</span><span class="sxs-lookup"><span data-stu-id="726b4-115">For more information about the code created by the compiler for an anonymous type, see [Anonymous Type Definition](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md).</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="726b4-116">Il nome del tipo anonimo è generato dal compilatore e può variare da compilazione a compilazione.</span><span class="sxs-lookup"><span data-stu-id="726b4-116">The name of the anonymous type is compiler generated and may vary from compilation to compilation.</span></span> <span data-ttu-id="726b4-117">Il codice deve usare o si basa sul nome di un tipo anonimo perché il nome potrebbe cambiare quando viene ricompilato un progetto.</span><span class="sxs-lookup"><span data-stu-id="726b4-117">Your code should not use or rely on the name of an anonymous type because the name might change when a project is recompiled.</span></span>  
  
## <a name="declaring-an-anonymous-type"></a><span data-ttu-id="726b4-118">La dichiarazione di un tipo anonimo</span><span class="sxs-lookup"><span data-stu-id="726b4-118">Declaring an Anonymous Type</span></span>  
 <span data-ttu-id="726b4-119">La dichiarazione di un'istanza di un tipo anonimo Usa un elenco di inizializzatori per specificare le proprietà del tipo.</span><span class="sxs-lookup"><span data-stu-id="726b4-119">The declaration of an instance of an anonymous type uses an initializer list to specify the properties of the type.</span></span> <span data-ttu-id="726b4-120">È possibile specificare solo proprietà quando si dichiara un tipo anonimo, non altri elementi della classe, ad esempio metodi o eventi.</span><span class="sxs-lookup"><span data-stu-id="726b4-120">You can specify only properties when you declare an anonymous type, not other class elements such as methods or events.</span></span> <span data-ttu-id="726b4-121">Nell'esempio riportato di seguito `product1` è un'istanza di un tipo anonimo che ha due proprietà: `Name` e `Price`.</span><span class="sxs-lookup"><span data-stu-id="726b4-121">In the following example, `product1` is an instance of an anonymous type that has two properties: `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#4)]  
  
 <span data-ttu-id="726b4-122">Se si definiscono le proprietà come proprietà chiave, è possibile usare per confrontare due istanze di tipo anonimo per verificarne l'uguaglianza.</span><span class="sxs-lookup"><span data-stu-id="726b4-122">If you designate properties as key properties, you can use them to compare two anonymous type instances for equality.</span></span> <span data-ttu-id="726b4-123">Tuttavia, i valori delle proprietà chiave non possono essere modificati.</span><span class="sxs-lookup"><span data-stu-id="726b4-123">However, the values of key properties cannot be changed.</span></span> <span data-ttu-id="726b4-124">Vedere la sezione delle proprietà di chiave più avanti in questo argomento per altre informazioni.</span><span class="sxs-lookup"><span data-stu-id="726b4-124">See the Key Properties section later in this topic for more information.</span></span>  
  
 <span data-ttu-id="726b4-125">Si noti che la dichiarazione di un'istanza di un tipo anonimo è come la dichiarazione di un'istanza di un tipo denominato con un inizializzatore di oggetto:</span><span class="sxs-lookup"><span data-stu-id="726b4-125">Notice that declaring an instance of an anonymous type is like declaring an instance of a named type by using an object initializer:</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#5)]  
  
 <span data-ttu-id="726b4-126">Per altre informazioni su altri modi per specificare le proprietà di tipo anonimo, vedere [come: In grado di dedurre i nomi delle proprietà e i tipi nelle dichiarazioni di tipo anonimo](../../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md).</span><span class="sxs-lookup"><span data-stu-id="726b4-126">For more information about other ways to specify anonymous type properties, see [How to: Infer Property Names and Types in Anonymous Type Declarations](../../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md).</span></span>  
  
## <a name="key-properties"></a><span data-ttu-id="726b4-127">Proprietà chiave</span><span class="sxs-lookup"><span data-stu-id="726b4-127">Key Properties</span></span>  
 <span data-ttu-id="726b4-128">Le proprietà di chiave sono diversi dalle proprietà non chiave in diversi modi fondamentali:</span><span class="sxs-lookup"><span data-stu-id="726b4-128">Key properties differ from non-key properties in several fundamental ways:</span></span>  
  
-   <span data-ttu-id="726b4-129">Solo i valori delle proprietà chiave vengono confrontati per determinare se due istanze sono uguali.</span><span class="sxs-lookup"><span data-stu-id="726b4-129">Only the values of key properties are compared in order to determine whether two instances are equal.</span></span>  
  
-   <span data-ttu-id="726b4-130">I valori delle proprietà chiave sono di sola lettura e non possono essere modificati.</span><span class="sxs-lookup"><span data-stu-id="726b4-130">The values of key properties are read-only and cannot be changed.</span></span>  
  
-   <span data-ttu-id="726b4-131">Solo i valori delle proprietà di chiave sono inclusi nell'algoritmo di codice hash generato dal compilatore per un tipo anonimo.</span><span class="sxs-lookup"><span data-stu-id="726b4-131">Only key property values are included in the compiler-generated hash code algorithm for an anonymous type.</span></span>  
  
### <a name="equality"></a><span data-ttu-id="726b4-132">Uguaglianza</span><span class="sxs-lookup"><span data-stu-id="726b4-132">Equality</span></span>  
 <span data-ttu-id="726b4-133">Istanze di tipi anonimi possono essere uguali solo se sono istanze dello stesso tipo anonimo.</span><span class="sxs-lookup"><span data-stu-id="726b4-133">Instances of anonymous types can be equal only if they are instances of the same anonymous type.</span></span> <span data-ttu-id="726b4-134">Il compilatore considera due istanze come istanze dello stesso tipo se soddisfano le condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="726b4-134">The compiler treats two instances as instances of the same type if they meet the following conditions:</span></span>  
  
-   <span data-ttu-id="726b4-135">Vengono dichiarati nello stesso assembly.</span><span class="sxs-lookup"><span data-stu-id="726b4-135">They are declared in the same assembly.</span></span>  
  
-   <span data-ttu-id="726b4-136">Le relative proprietà hanno lo stesso nome, gli stessi tipi derivati e vengono dichiarate nello stesso ordine.</span><span class="sxs-lookup"><span data-stu-id="726b4-136">Their properties have the same names, the same inferred types, and are declared in the same order.</span></span> <span data-ttu-id="726b4-137">I confronti tra nomi non sono tra maiuscole e minuscole.</span><span class="sxs-lookup"><span data-stu-id="726b4-137">Name comparisons are not case-sensitive.</span></span>  
  
-   <span data-ttu-id="726b4-138">Le stesse proprietà in ogni sono contrassegnate come proprietà chiave.</span><span class="sxs-lookup"><span data-stu-id="726b4-138">The same properties in each are marked as key properties.</span></span>  
  
-   <span data-ttu-id="726b4-139">Almeno una proprietà in ogni dichiarazione è una proprietà chiave.</span><span class="sxs-lookup"><span data-stu-id="726b4-139">At least one property in each declaration is a key property.</span></span>  
  
 <span data-ttu-id="726b4-140">Un'istanza di tipi anonimi che non ha proprietà chiave è uguale solo a se stesso.</span><span class="sxs-lookup"><span data-stu-id="726b4-140">An instance of an anonymous types that has no key properties is equal only to itself.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#6)]  
  
 <span data-ttu-id="726b4-141">Due istanze dello stesso tipo anonimo sono uguali se i valori delle relative proprietà chiave sono uguali.</span><span class="sxs-lookup"><span data-stu-id="726b4-141">Two instances of the same anonymous type are equal if the values of their key properties are equal.</span></span> <span data-ttu-id="726b4-142">Gli esempi seguenti illustrano come viene verificata l'uguaglianza.</span><span class="sxs-lookup"><span data-stu-id="726b4-142">The following examples illustrate how equality is tested.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#7)]  
  
### <a name="read-only-values"></a><span data-ttu-id="726b4-143">Valori di sola lettura</span><span class="sxs-lookup"><span data-stu-id="726b4-143">Read-Only Values</span></span>  
 <span data-ttu-id="726b4-144">I valori delle proprietà chiave non possono essere modificati.</span><span class="sxs-lookup"><span data-stu-id="726b4-144">The values of key properties cannot be changed.</span></span> <span data-ttu-id="726b4-145">Ad esempio, nella `prod8` nell'esempio precedente, il `Name` e `Price` campi sono `read-only`, ma `OnHand` può essere modificato.</span><span class="sxs-lookup"><span data-stu-id="726b4-145">For example, in `prod8` in the previous example, the `Name` and `Price` fields are `read-only`, but `OnHand` can be changed.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#8)]  
  
## <a name="anonymous-types-from-query-expressions"></a><span data-ttu-id="726b4-146">Tipi anonimi da espressioni di Query</span><span class="sxs-lookup"><span data-stu-id="726b4-146">Anonymous Types from Query Expressions</span></span>  
 <span data-ttu-id="726b4-147">Le espressioni di query non richiedono sempre la creazione di tipi anonimi.</span><span class="sxs-lookup"><span data-stu-id="726b4-147">Query expressions do not always require the creation of anonymous types.</span></span> <span data-ttu-id="726b4-148">Quando possibile, usano un tipo esistente per contenere i dati della colonna.</span><span class="sxs-lookup"><span data-stu-id="726b4-148">When possible, they use an existing type to hold the column data.</span></span> <span data-ttu-id="726b4-149">Ciò si verifica quando la query restituisce l'intero record dall'origine dei dati, o un solo campo di ogni record.</span><span class="sxs-lookup"><span data-stu-id="726b4-149">This occurs when the query returns either whole records from the data source, or only one field from each record.</span></span> <span data-ttu-id="726b4-150">Negli esempi di codice seguente, `customers` è una raccolta di oggetti di un `Customer` classe.</span><span class="sxs-lookup"><span data-stu-id="726b4-150">In the following code examples, `customers` is a collection of objects of a `Customer` class.</span></span> <span data-ttu-id="726b4-151">La classe dispone di molte proprietà e si può includere uno o più di esse nel risultato della query, in qualsiasi ordine.</span><span class="sxs-lookup"><span data-stu-id="726b4-151">The class has many properties, and you can include one or more of them in the query result, in any order.</span></span> <span data-ttu-id="726b4-152">Nei primi due esempi, non i tipi anonimi sono necessari perché la query Seleziona gli elementi di tipi denominati:</span><span class="sxs-lookup"><span data-stu-id="726b4-152">In the first two examples, no anonymous types are required because the queries select elements of named types:</span></span>  
  
-   <span data-ttu-id="726b4-153">`custs1` contiene una raccolta di stringhe, in quanto `cust.Name` è una stringa.</span><span class="sxs-lookup"><span data-stu-id="726b4-153">`custs1` contains a collection of strings, because `cust.Name` is a string.</span></span>  
  
     [!code-vb[VbVbalrAnonymousTypes#30](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#30)]  
  
-   <span data-ttu-id="726b4-154">`custs2` contiene una raccolta di `Customer` oggetti, perché ogni elemento della `customers` è un `Customer` oggetto e l'intero elemento è selezionato dalla query.</span><span class="sxs-lookup"><span data-stu-id="726b4-154">`custs2` contains a collection of `Customer` objects, because each element of `customers` is a `Customer` object, and the whole element is selected by the query.</span></span>  
  
     [!code-vb[VbVbalrAnonymousTypes#31](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#31)]  
  
 <span data-ttu-id="726b4-155">Tuttavia, i tipi denominati appropriati non sono sempre disponibili.</span><span class="sxs-lookup"><span data-stu-id="726b4-155">However, appropriate named types are not always available.</span></span> <span data-ttu-id="726b4-156">È possibile selezionare i nomi dei clienti e indirizzi per uno degli scopi, i numeri di ID cliente e percorsi per un altro e i nomi dei clienti, gli indirizzi e le cronologie di ordine per un terzo.</span><span class="sxs-lookup"><span data-stu-id="726b4-156">You might want to select customer names and addresses for one purpose, customer ID numbers and locations for another, and customer names, addresses, and order histories for a third.</span></span> <span data-ttu-id="726b4-157">I tipi anonimi consentono di selezionare qualsiasi combinazione delle proprietà, in qualsiasi ordine, senza prima dichiarare un nuovo tipo denominato per contenere il risultato.</span><span class="sxs-lookup"><span data-stu-id="726b4-157">Anonymous types enable you to select any combination of properties, in any order, without first declaring a new named type to hold the result.</span></span> <span data-ttu-id="726b4-158">Al contrario, il compilatore crea un tipo anonimo per ogni compilazione delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="726b4-158">Instead, the compiler creates an anonymous type for each compilation of properties.</span></span> <span data-ttu-id="726b4-159">La query seguente consente di selezionare solo il nome del cliente e il numero ID da ognuna `Customer` dell'oggetto `customers`.</span><span class="sxs-lookup"><span data-stu-id="726b4-159">The following query selects only the customer's name and ID number from each `Customer` object in `customers`.</span></span> <span data-ttu-id="726b4-160">Pertanto, il compilatore crea un tipo anonimo che contiene solo queste due proprietà.</span><span class="sxs-lookup"><span data-stu-id="726b4-160">Therefore, the compiler creates an anonymous type that contains only those two properties.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTYpes#32](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#32)]  
  
 <span data-ttu-id="726b4-161">I nomi e i tipi di dati delle proprietà nel tipo anonimo provengono dagli argomenti per `Select`, `cust.Name` e `cust.ID`.</span><span class="sxs-lookup"><span data-stu-id="726b4-161">Both the names and the data types of the properties in the anonymous type are taken from the arguments to `Select`, `cust.Name` and `cust.ID`.</span></span> <span data-ttu-id="726b4-162">Le proprietà in un tipo anonimo che viene creato da una query sono sempre le proprietà di chiave.</span><span class="sxs-lookup"><span data-stu-id="726b4-162">The properties in an anonymous type that is created by a query are always key properties.</span></span> <span data-ttu-id="726b4-163">Quando `custs3` viene eseguita nell'esempio seguente `For Each` ciclo, il risultato è una raccolta di istanze di un tipo anonimo con due proprietà chiave, `Name` e `ID`.</span><span class="sxs-lookup"><span data-stu-id="726b4-163">When `custs3` is executed in the following `For Each` loop, the result is a collection of instances of an anonymous type with two key properties, `Name` and `ID`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#33](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#33)]  
  
 <span data-ttu-id="726b4-164">Gli elementi della raccolta rappresentata da `custs3` sono fortemente tipizzate, ed è possibile usare IntelliSense per spostarsi tra le proprietà disponibili e verificare i relativi tipi.</span><span class="sxs-lookup"><span data-stu-id="726b4-164">The elements in the collection represented by `custs3` are strongly typed, and you can use IntelliSense to navigate through the available properties and to verify their types.</span></span>  
  
 <span data-ttu-id="726b4-165">Per altre informazioni, vedere [Introduzione a LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md).</span><span class="sxs-lookup"><span data-stu-id="726b4-165">For more information, see [Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md).</span></span>  
  
## <a name="deciding-whether-to-use-anonymous-types"></a><span data-ttu-id="726b4-166">Decidere se usare i tipi anonimi</span><span class="sxs-lookup"><span data-stu-id="726b4-166">Deciding Whether to Use Anonymous Types</span></span>  
 <span data-ttu-id="726b4-167">Prima di creare un oggetto come un'istanza di una classe anonima, valutare se sia l'opzione migliore.</span><span class="sxs-lookup"><span data-stu-id="726b4-167">Before you create an object as an instance of an anonymous class, consider whether that is the best option.</span></span> <span data-ttu-id="726b4-168">Ad esempio, se si desidera creare un oggetto temporaneo per contenere i dati correlati e non è necessario per gli altri campi e metodi che può contenere una classe completa, un tipo anonimo è un'ottima soluzione.</span><span class="sxs-lookup"><span data-stu-id="726b4-168">For example, if you want to create a temporary object to contain related data, and you have no need for other fields and methods that a complete class might contain, an anonymous type is a good solution.</span></span> <span data-ttu-id="726b4-169">I tipi anonimi sono anche utili se si vuole un'opzione diversa delle proprietà per ogni dichiarazione, o se si desidera modificare l'ordine delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="726b4-169">Anonymous types are also convenient if you want a different selection of properties for each declaration, or if you want to change the order of the properties.</span></span> <span data-ttu-id="726b4-170">Tuttavia, se il progetto include molti oggetti che hanno le stesse proprietà, in un ordine fisso, è possibile dichiararle in più facilmente utilizzando un tipo denominato con un costruttore di classe.</span><span class="sxs-lookup"><span data-stu-id="726b4-170">However, if your project includes several objects that have the same properties, in a fixed order, you can declare them more easily by using a named type with a class constructor.</span></span> <span data-ttu-id="726b4-171">Ad esempio, con un costruttore appropriato e risulta più semplice dichiarare più istanze di un `Product` classe anziché dichiarare più istanze di un tipo anonimo.</span><span class="sxs-lookup"><span data-stu-id="726b4-171">For example, with an appropriate constructor, it is easier to declare several instances of a `Product` class than it is to declare several instances of an anonymous type.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#9)]  
  
 <span data-ttu-id="726b4-172">Un altro vantaggio di tipi denominati è che il compilatore può intercettare un accidentale errata digitazione del nome di una proprietà.</span><span class="sxs-lookup"><span data-stu-id="726b4-172">Another advantage of named types is that the compiler can catch an accidental mistyping of a property name.</span></span> <span data-ttu-id="726b4-173">Negli esempi precedenti `firstProd2`, `secondProd2`, e `thirdProd2` dovranno essere istanze dello stesso tipo anonimo.</span><span class="sxs-lookup"><span data-stu-id="726b4-173">In the previous examples, `firstProd2`, `secondProd2`, and `thirdProd2` are intended to be instances of the same anonymous type.</span></span> <span data-ttu-id="726b4-174">Tuttavia, se si dovesse inavvertitamente dichiarare `thirdProd2` in uno dei modi seguenti, è diverso da quello del relativo tipo `firstProd2` e `secondProd2`.</span><span class="sxs-lookup"><span data-stu-id="726b4-174">However, if you were to accidentally declare `thirdProd2` in one of the following ways, its type would be different from that of `firstProd2` and `secondProd2`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#10](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#10)]  
  
 <span data-ttu-id="726b4-175">Ancora più importante, esistono limitazioni sull'utilizzo di tipi anonimi che non si applicano alle istanze di tipi denominati.</span><span class="sxs-lookup"><span data-stu-id="726b4-175">More importantly, there are limitations on the use of anonymous types that do not apply to instances of named types.</span></span> <span data-ttu-id="726b4-176">`firstProd2`, `secondProd2`, e `thirdProd2` sono istanze dello stesso tipo anonimo.</span><span class="sxs-lookup"><span data-stu-id="726b4-176">`firstProd2`, `secondProd2`, and `thirdProd2` are instances of the same anonymous type.</span></span> <span data-ttu-id="726b4-177">Tuttavia, il nome per il tipo anonimo condiviso non è disponibile e non può essere specificata in cui è previsto un nome di tipo nel codice.</span><span class="sxs-lookup"><span data-stu-id="726b4-177">However, the name for the shared anonymous type is not available and cannot appear where a type name is expected in your code.</span></span> <span data-ttu-id="726b4-178">Ad esempio, un tipo anonimo non è utilizzabile per definire una firma del metodo, per dichiarare un'altra variabile o un campo o in qualsiasi dichiarazione di tipo.</span><span class="sxs-lookup"><span data-stu-id="726b4-178">For example, an anonymous type cannot be used to define a method signature, to declare another variable or field, or in any type declaration.</span></span> <span data-ttu-id="726b4-179">Di conseguenza, i tipi anonimi non sono appropriati quando si desidera condividere informazioni tra i metodi.</span><span class="sxs-lookup"><span data-stu-id="726b4-179">As a result, anonymous types are not appropriate when you have to share information across methods.</span></span>  
  
## <a name="an-anonymous-type-definition"></a><span data-ttu-id="726b4-180">Una definizione di tipo anonimo</span><span class="sxs-lookup"><span data-stu-id="726b4-180">An Anonymous Type Definition</span></span>  
 <span data-ttu-id="726b4-181">In risposta alla dichiarazione di un'istanza di un tipo anonimo, il compilatore crea una nuova definizione di classe che contiene le proprietà specificate.</span><span class="sxs-lookup"><span data-stu-id="726b4-181">In response to the declaration of an instance of an anonymous type, the compiler creates a new class definition that contains the specified properties.</span></span>  
  
 <span data-ttu-id="726b4-182">Se il tipo anonimo contiene almeno una proprietà chiave, la definizione esegue l'override di tre membri ereditati da <xref:System.Object>: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, e <xref:System.Object.ToString%2A>.</span><span class="sxs-lookup"><span data-stu-id="726b4-182">If the anonymous type contains at least one key property, the definition overrides three members inherited from <xref:System.Object>: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, and <xref:System.Object.ToString%2A>.</span></span> <span data-ttu-id="726b4-183">Il codice generato per verificare l'uguaglianza e che determina che il valore del codice hash vengono considerate solo le proprietà della chiave.</span><span class="sxs-lookup"><span data-stu-id="726b4-183">The code produced for testing equality and determining the hash code value considers only the key properties.</span></span> <span data-ttu-id="726b4-184">Se il tipo anonimo non contiene proprietà chiave, solo <xref:System.Object.ToString%2A> viene sottoposto a override.</span><span class="sxs-lookup"><span data-stu-id="726b4-184">If the anonymous type contains no key properties, only <xref:System.Object.ToString%2A> is overridden.</span></span> <span data-ttu-id="726b4-185">Proprietà denominate in modo esplicito di un tipo anonimo non è in conflitto con questi metodi generati.</span><span class="sxs-lookup"><span data-stu-id="726b4-185">Explicitly named properties of an anonymous type cannot conflict with these generated methods.</span></span> <span data-ttu-id="726b4-186">Vale a dire, non è possibile usare `.Equals`, `.GetHashCode`, o `.ToString` per assegnare un nome di una proprietà.</span><span class="sxs-lookup"><span data-stu-id="726b4-186">That is, you cannot use `.Equals`, `.GetHashCode`, or `.ToString` to name a property.</span></span>  
  
 <span data-ttu-id="726b4-187">Le definizioni di tipo anonimo che hanno almeno una proprietà chiave implementano anche il <xref:System.IEquatable%601?displayProperty=nameWithType> interfaccia, in cui `T` è il tipo del tipo anonimo.</span><span class="sxs-lookup"><span data-stu-id="726b4-187">Anonymous type definitions that have at least one key property also implement the <xref:System.IEquatable%601?displayProperty=nameWithType> interface, where `T` is the type of the anonymous type.</span></span>  
  
 <span data-ttu-id="726b4-188">Per altre informazioni sul codice creato dal compilatore e le funzionalità dei metodi sottoposti a override, vedere [definizione di tipo anonimo](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md).</span><span class="sxs-lookup"><span data-stu-id="726b4-188">For more information about the code created by the compiler and the functionality of the overridden methods, see [Anonymous Type Definition](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="726b4-189">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="726b4-189">See also</span></span>
- [<span data-ttu-id="726b4-190">Inizializzatori di oggetto: Tipi denominati e anonimi</span><span class="sxs-lookup"><span data-stu-id="726b4-190">Object Initializers: Named and Anonymous Types</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)
- [<span data-ttu-id="726b4-191">Inferenza del tipo di variabile locale</span><span class="sxs-lookup"><span data-stu-id="726b4-191">Local Type Inference</span></span>](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)
- [<span data-ttu-id="726b4-192">Introduzione a LINQ in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="726b4-192">Introduction to LINQ in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)
- [<span data-ttu-id="726b4-193">Procedura: Dedurre i nomi delle proprietà e i tipi nelle dichiarazioni di tipo anonimo</span><span class="sxs-lookup"><span data-stu-id="726b4-193">How to: Infer Property Names and Types in Anonymous Type Declarations</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)
- [<span data-ttu-id="726b4-194">Definizione di tipo anonimo</span><span class="sxs-lookup"><span data-stu-id="726b4-194">Anonymous Type Definition</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md)
- [<span data-ttu-id="726b4-195">Key</span><span class="sxs-lookup"><span data-stu-id="726b4-195">Key</span></span>](../../../../visual-basic/language-reference/modifiers/key.md)
